import{game as e}from"https://2gemstore.staticwars.com/services/2native/gen/native-bundle.4c2e12c4-svc.js";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var i,a={exports:{}};i=a,function(){function e(e,t,n,i,a,r){return{tag:e,key:t,attrs:n,children:i,text:a,dom:r,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}e.normalize=function(t){return Array.isArray(t)?e("[",void 0,void 0,e.normalizeChildren(t),void 0,void 0):null!=t&&"object"!=typeof t?e("#",void 0,void 0,!1===t?"":t,void 0,void 0):t},e.normalizeChildren=function(t){for(var n=0;n<t.length;n++)t[n]=e.normalize(t[n]);return t};var n=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,a={},r={}.hasOwnProperty;function s(e){for(var t,i="div",r=[],s={};t=n.exec(e);){var o=t[1],c=t[2];if(""===o&&""!==c)i=c;else if("#"===o)s.id=c;else if("."===o)r.push(c);else if("["===t[3][0]){var l=t[6];l&&(l=l.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===t[4]?r.push(l):s[t[4]]=l||!0}}return r.length>0&&(s.className=r.join(" ")),a[e]={tag:i,attrs:s}}function o(t,n,i){var a,s,o=!1,c=n.className||n.class;for(var l in t.attrs)r.call(t.attrs,l)&&(n[l]=t.attrs[l]);for(var l in void 0!==c&&(void 0!==n.class&&(n.class=void 0,n.className=c),null!=t.attrs.className&&(n.className=t.attrs.className+" "+c)),n)if(r.call(n,l)&&"key"!==l){o=!0;break}return Array.isArray(i)&&1===i.length&&null!=i[0]&&"#"===i[0].tag?s=i[0].children:a=i,e(t.tag,n.key,o?n:void 0,a,s)}function c(t){var n,i=arguments[1],r=2;if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");if("string"==typeof t)var c=a[t]||s(t);if(null==i?i={}:("object"!=typeof i||null!=i.tag||Array.isArray(i))&&(i={},r=1),arguments.length===r+1)n=arguments[r],Array.isArray(n)||(n=[n]);else for(n=[];r<arguments.length;)n.push(arguments[r++]);var l=e.normalizeChildren(n);return"string"==typeof t?o(c,i,l):e(t,i.key,i,l)}c.trust=function(t){return null==t&&(t=""),e("<",void 0,void 0,t,void 0,void 0)},c.fragment=function(t,n){return e("[",t.key,t,e.normalizeChildren(n),void 0,void 0)};var l=c,u=function(e){if(!(this instanceof u))throw new Error("Promise must be called with `new`");if("function"!=typeof e)throw new TypeError("executor must be a function");var t=this,n=[],i=[],a=c(n,!0),r=c(i,!1),s=t._instance={resolvers:n,rejectors:i},o="function"==typeof setImmediate?setImmediate:setTimeout;function c(e,a){return function c(u){var d;try{if(!a||null==u||"object"!=typeof u&&"function"!=typeof u||"function"!=typeof(d=u.then))o((function(){a||0!==e.length||console.error("Possible unhandled promise rejection:",u);for(var t=0;t<e.length;t++)e[t](u);n.length=0,i.length=0,s.state=a,s.retry=function(){c(u)}}));else{if(u===t)throw new TypeError("Promise can't be resolved w/ itself");l(d.bind(u))}}catch(e){r(e)}}}function l(e){var t=0;function n(e){return function(n){t++>0||e(n)}}var i=n(r);try{e(n(a),i)}catch(e){i(e)}}l(e)};u.prototype.then=function(e,t){var n,i,a=this._instance;function r(e,t,r,s){t.push((function(t){if("function"!=typeof e)r(t);else try{n(e(t))}catch(e){i&&i(e)}})),"function"==typeof a.retry&&s===a.state&&a.retry()}var s=new u((function(e,t){n=e,i=t}));return r(e,a.resolvers,n,!0),r(t,a.rejectors,i,!1),s},u.prototype.catch=function(e){return this.then(null,e)},u.resolve=function(e){return e instanceof u?e:new u((function(t){t(e)}))},u.reject=function(e){return new u((function(t,n){n(e)}))},u.all=function(e){return new u((function(t,n){var i=e.length,a=0,r=[];if(0===e.length)t([]);else for(var s=0;s<e.length;s++)!function(s){function o(e){a++,r[s]=e,a===i&&t(r)}null==e[s]||"object"!=typeof e[s]&&"function"!=typeof e[s]||"function"!=typeof e[s].then?o(e[s]):e[s].then(o,n)}(s)}))},u.race=function(e){return new u((function(t,n){for(var i=0;i<e.length;i++)e[i].then(t,n)}))},"undefined"!=typeof window?(void 0===window.Promise&&(window.Promise=u),u=window.Promise):void 0!==t&&(void 0===t.Promise&&(t.Promise=u),u=t.Promise);var d,m=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return"";var t=[];for(var n in e)i(n,e[n]);return t.join("&");function i(e,n){if(Array.isArray(n))for(var a=0;a<n.length;a++)i(e+"["+a+"]",n[a]);else if("[object Object]"===Object.prototype.toString.call(n))for(var a in n)i(e+"["+a+"]",n[a]);else t.push(encodeURIComponent(e)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},g=new RegExp("^file://","i"),f=function(e,t){var n,i=0;function a(){var e=0;function t(){0==--e&&"function"==typeof n&&n()}return function n(i){var a=i.then;return i.then=function(){e++;var r=a.apply(i,arguments);return r.then(t,(function(n){if(t(),0===e)throw n})),n(r)},i}}function r(e,t){if("string"==typeof e){var n=e;null==(e=t||{}).url&&(e.url=n)}return e}function s(e,t){if(null==t)return e;for(var n=e.match(/:[^\/]+/gi)||[],i=0;i<n.length;i++){var a=n[i].slice(1);null!=t[a]&&(e=e.replace(n[i],t[a]))}return e}function o(e,t){var n=m(t);if(""!==n){var i=e.indexOf("?")<0?"?":"&";e+=i+n}return e}function c(e){try{return""!==e?JSON.parse(e):null}catch(t){throw new Error(e)}}function l(e){return e.responseText}function u(e,t){if("function"==typeof e){if(!Array.isArray(t))return new e(t);for(var n=0;n<t.length;n++)t[n]=new e(t[n])}return t}return{request:function(n,i){var d=a();n=r(n,i);var m=new t((function(t,i){null==n.method&&(n.method="GET"),n.method=n.method.toUpperCase();var a="GET"!==n.method&&"TRACE"!==n.method&&("boolean"!=typeof n.useBody||n.useBody);"function"!=typeof n.serialize&&(n.serialize="undefined"!=typeof FormData&&n.data instanceof FormData?function(e){return e}:JSON.stringify),"function"!=typeof n.deserialize&&(n.deserialize=c),"function"!=typeof n.extract&&(n.extract=l),n.url=s(n.url,n.data),a?n.data=n.serialize(n.data):n.url=o(n.url,n.data);var r=new e.XMLHttpRequest,d=!1,m=r.abort;for(var f in r.abort=function(){d=!0,m.call(r)},r.open(n.method,n.url,"boolean"!=typeof n.async||n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),n.serialize===JSON.stringify&&a&&r.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize===c&&r.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(r.withCredentials=n.withCredentials),n.headers)({}).hasOwnProperty.call(n.headers,f)&&r.setRequestHeader(f,n.headers[f]);"function"==typeof n.config&&(r=n.config(r,n)||r),r.onreadystatechange=function(){if(!d&&4===r.readyState)try{var e=n.extract!==l?n.extract(r,n):n.deserialize(n.extract(r,n));if(r.status>=200&&r.status<300||304===r.status||g.test(n.url))t(u(n.type,e));else{var a=new Error(r.responseText);for(var s in e)a[s]=e[s];i(a)}}catch(e){i(e)}},a&&null!=n.data?r.send(n.data):r.send()}));return!0===n.background?m:d(m)},jsonp:function(n,c){var l=a();n=r(n,c);var d=new t((function(t,a){var r=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,c=e.document.createElement("script");e[r]=function(i){c.parentNode.removeChild(c),t(u(n.type,i)),delete e[r]},c.onerror=function(){c.parentNode.removeChild(c),a(new Error("JSONP request failed")),delete e[r]},null==n.data&&(n.data={}),n.url=s(n.url,n.data),n.data[n.callbackKey||"callback"]=r,c.src=o(n.url,n.data),e.document.documentElement.appendChild(c)}));return!0===n.background?d:l(d)},setCompletionCallback:function(e){n=e}}}(window,u),p=function(t){var n,i=t.document,a=i.createDocumentFragment();function r(e,t,n,i,a,r,o){for(var c=n;c<i;c++){var l=t[c];null!=l&&s(e,l,a,o,r)}}function s(t,n,l,u,d){var m=n.tag;if("string"!=typeof m)return function(e,t,n,i,r){if(c(t,n),null!=t.instance){var o=s(e,t.instance,n,i,r);return t.dom=t.instance.dom,t.domSize=null!=t.dom?t.instance.domSize:0,f(e,o,r),o}return t.domSize=0,a}(t,n,l,u,d);switch(n.state={},null!=n.attrs&&k(n.attrs,n,l),m){case"#":return function(e,t,n){return t.dom=i.createTextNode(t.children),f(e,t.dom,n),t.dom}(t,n,d);case"<":return o(t,n,d);case"[":return function(e,t,n,a,s){var o=i.createDocumentFragment();if(null!=t.children){var c=t.children;r(o,c,0,c.length,n,null,a)}return t.dom=o.firstChild,t.domSize=o.childNodes.length,f(e,o,s),o}(t,n,l,u,d);default:return function(t,n,a,s,o){var c=n.tag;switch(n.tag){case"svg":s="http://www.w3.org/2000/svg";break;case"math":s="http://www.w3.org/1998/Math/MathML"}var l=n.attrs,u=l&&l.is,d=s?u?i.createElementNS(s,c,{is:u}):i.createElementNS(s,c):u?i.createElement(c,{is:u}):i.createElement(c);if(n.dom=d,null!=l&&function(e,t,n){for(var i in t)_(e,i,null,t[i],n)}(n,l,s),f(t,d,o),null!=n.attrs&&null!=n.attrs.contenteditable)p(n);else if(null!=n.text&&(""!==n.text?d.textContent=n.text:n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),null!=n.children){var m=n.children;r(d,m,0,m.length,a,null,s),function(e){var t=e.attrs;"select"===e.tag&&null!=t&&("value"in t&&_(e,"value",null,t.value,void 0),"selectedIndex"in t&&_(e,"selectedIndex",null,t.selectedIndex,void 0))}(n)}return d}(t,n,l,u,d)}}function o(e,t,n){var a={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(t.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",r=i.createElement(a);r.innerHTML=t.children,t.dom=r.firstChild,t.domSize=r.childNodes.length;for(var s,o=i.createDocumentFragment();s=r.firstChild;)o.appendChild(s);return f(e,o,n),o}function c(t,n){var i;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(i=t.state.view).$$reentrantLock$$)return a;i.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(i=t.tag).$$reentrantLock$$)return a;i.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(t._state=t.state,null!=t.attrs&&k(t.attrs,t,n),k(t._state,t,n),t.instance=e.normalize(t._state.view.call(t.state,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null}function l(e,t,n,i,a,o,c){if(t!==n&&(null!=t||null!=n))if(null==t)r(e,n,0,n.length,a,o,void 0);else if(null==n)h(t,0,t.length,n);else{if(t.length===n.length){for(var l=!1,p=0;p<n.length;p++)if(null!=n[p]&&null!=t[p]){l=null==n[p].key&&null==t[p].key;break}if(l){for(p=0;p<t.length;p++)t[p]!==n[p]&&(null==t[p]&&null!=n[p]?s(e,n[p],a,c,g(t,p+1,o)):null==n[p]?h(t,p,p+1,n):u(e,t[p],n[p],a,g(t,p+1,o),i,c));return}}if(i=i||function(e,t){if(null!=e.pool&&Math.abs(e.pool.length-t.length)<=Math.abs(e.length-t.length)){var n=e[0]&&e[0].children&&e[0].children.length||0,i=e.pool[0]&&e.pool[0].children&&e.pool[0].children.length||0,a=t[0]&&t[0].children&&t[0].children.length||0;if(Math.abs(i-a)<=Math.abs(n-a))return!0}return!1}(t,n),i){var v=t.pool;t=t.concat(t.pool)}for(var b,y=0,_=0,w=t.length-1,x=n.length-1;w>=y&&x>=_;)if((I=t[y])!==(T=n[_])||i)if(null==I)y++;else if(null==T)_++;else if(I.key===T.key){var k=null!=v&&y>=t.length-v.length||null==v&&i;_++,u(e,I,T,a,g(t,++y,o),k,c),i&&I.tag===T.tag&&f(e,m(I),o)}else if((I=t[w])!==T||i)if(null==I)w--;else if(null==T)_++;else{if(I.key!==T.key)break;k=null!=v&&w>=t.length-v.length||null==v&&i,u(e,I,T,a,g(t,w+1,o),k,c),(i||_<x)&&f(e,m(I),g(t,y,o)),w--,_++}else w--,_++;else y++,_++;for(;w>=y&&x>=_;){var I,T;if((I=t[w])!==(T=n[x])||i)if(null==I)w--;else if(null==T)x--;else if(I.key===T.key)k=null!=v&&w>=t.length-v.length||null==v&&i,u(e,I,T,a,g(t,w+1,o),k,c),i&&I.tag===T.tag&&f(e,m(I),o),null!=I.dom&&(o=I.dom),w--,x--;else{if(b||(b=d(t,w)),null!=T){var C=b[T.key];if(null!=C){var P=t[C];k=null!=v&&C>=t.length-v.length||null==v&&i,u(e,P,T,a,g(t,w+1,o),i,c),f(e,m(P),o),t[C].skip=!0,null!=P.dom&&(o=P.dom)}else o=s(e,T,a,void 0,o)}x--}else w--,x--;if(x<_)break}r(e,n,_,x+1,a,o,c),h(t,y,w+1,n)}}function u(t,n,i,a,r,d,g){var f=n.tag;if(f===i.tag){if(i.state=n.state,i._state=n._state,i.events=n.events,!d&&function(e,t){var n,i;return null!=e.attrs&&"function"==typeof e.attrs.onbeforeupdate&&(n=e.attrs.onbeforeupdate.call(e.state,e,t)),"string"!=typeof e.tag&&"function"==typeof e._state.onbeforeupdate&&(i=e._state.onbeforeupdate.call(e.state,e,t)),!(void 0===n&&void 0===i||n||i)&&(e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,!0)}(i,n))return;if("string"==typeof f)switch(null!=i.attrs&&(d?(i.state={},k(i.attrs,i,a)):I(i.attrs,i,a)),f){case"#":!function(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children),t.dom=e.dom}(n,i);break;case"<":!function(e,t,n,i){t.children!==n.children?(m(t),o(e,n,i)):(n.dom=t.dom,n.domSize=t.domSize)}(t,n,i,r);break;case"[":!function(e,t,n,i,a,r,s){l(e,t.children,n.children,i,a,r,s);var o=0,c=n.children;if(n.dom=null,null!=c){for(var u=0;u<c.length;u++){var d=c[u];null!=d&&null!=d.dom&&(null==n.dom&&(n.dom=d.dom),o+=d.domSize||1)}1!==o&&(n.domSize=o)}}(t,n,i,d,a,r,g);break;default:!function(t,n,i,a,r){var s=n.dom=t.dom;switch(n.tag){case"svg":r="http://www.w3.org/2000/svg";break;case"math":r="http://www.w3.org/1998/Math/MathML"}"textarea"===n.tag&&(null==n.attrs&&(n.attrs={}),null!=n.text&&(n.attrs.value=n.text,n.text=void 0)),function(e,t,n,i){if(null!=n)for(var a in n)_(e,a,t&&t[a],n[a],i);if(null!=t)for(var a in t)null!=n&&a in n||("className"===a&&(a="class"),"o"!==a[0]||"n"!==a[1]||w(a)?"key"!==a&&e.dom.removeAttribute(a):x(e,a,void 0))}(n,t.attrs,n.attrs,r),null!=n.attrs&&null!=n.attrs.contenteditable?p(n):null!=t.text&&null!=n.text&&""!==n.text?t.text.toString()!==n.text.toString()&&(t.dom.firstChild.nodeValue=n.text):(null!=t.text&&(t.children=[e("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=n.text&&(n.children=[e("#",void 0,void 0,n.text,void 0,void 0)]),l(s,t.children,n.children,i,a,null,r))}(n,i,d,a,g)}else!function(t,n,i,a,r,o,l){if(o)c(i,a);else{if(i.instance=e.normalize(i._state.view.call(i.state,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");null!=i.attrs&&I(i.attrs,i,a),I(i._state,i,a)}null!=i.instance?(null==n.instance?s(t,i.instance,a,l,r):u(t,n.instance,i.instance,a,r,o,l),i.dom=i.instance.dom,i.domSize=i.instance.domSize):null!=n.instance?(v(n.instance,null),i.dom=void 0,i.domSize=0):(i.dom=n.dom,i.domSize=n.domSize)}(t,n,i,a,r,d,g)}else v(n,null),s(t,i,a,g,r)}function d(e,t){var n={},i=0;for(i=0;i<t;i++){var a=e[i];if(null!=a){var r=a.key;null!=r&&(n[r]=i)}}return n}function m(e){var t=e.domSize;if(null!=t||null==e.dom){var n=i.createDocumentFragment();if(t>0){for(var a=e.dom;--t;)n.appendChild(a.nextSibling);n.insertBefore(a,n.firstChild)}return n}return e.dom}function g(e,t,n){for(;t<e.length;t++)if(null!=e[t]&&null!=e[t].dom)return e[t].dom;return n}function f(e,t,n){n&&n.parentNode?e.insertBefore(t,n):e.appendChild(t)}function p(e){var t=e.children;if(null!=t&&1===t.length&&"<"===t[0].tag){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(null!=e.text||null!=t&&0!==t.length)throw new Error("Child node of a contenteditable must be trusted")}function h(e,t,n,i){for(var a=t;a<n;a++){var r=e[a];null!=r&&(r.skip?r.skip=!1:v(r,i))}}function v(e,t){var n,i=1,a=0;function r(){if(++a===i&&(y(e),e.dom)){var n=e.domSize||1;if(n>1)for(var r=e.dom;--n;)b(r.nextSibling);b(e.dom),null==t||null!=e.domSize||null!=(s=e.attrs)&&(s.oncreate||s.onupdate||s.onbeforeremove||s.onremove)||"string"!=typeof e.tag||(t.pool?t.pool.push(e):t.pool=[e])}var s}e.attrs&&"function"==typeof e.attrs.onbeforeremove&&null!=(n=e.attrs.onbeforeremove.call(e.state,e))&&"function"==typeof n.then&&(i++,n.then(r,r)),"string"!=typeof e.tag&&"function"==typeof e._state.onbeforeremove&&null!=(n=e._state.onbeforeremove.call(e.state,e))&&"function"==typeof n.then&&(i++,n.then(r,r)),r()}function b(e){var t=e.parentNode;null!=t&&t.removeChild(e)}function y(e){if(e.attrs&&"function"==typeof e.attrs.onremove&&e.attrs.onremove.call(e.state,e),"string"!=typeof e.tag&&"function"==typeof e._state.onremove&&e._state.onremove.call(e.state,e),null!=e.instance)y(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];null!=i&&y(i)}}}function _(e,t,n,a,r){var s=e.dom;if("key"!==t&&"is"!==t&&(n!==a||function(e,t){return"value"===t||"checked"===t||"selectedIndex"===t||"selected"===t&&e.dom===i.activeElement}(e,t)||"object"==typeof a)&&void 0!==a&&!w(t)){var o,c=t.indexOf(":");if(c>-1&&"xlink"===t.substr(0,c))s.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(c+1),a);else if("o"===t[0]&&"n"===t[1]&&"function"==typeof a)x(e,t,a);else if("style"===t)!function(e,t,n){if(t===n&&(e.style.cssText="",t=null),null==n)e.style.cssText="";else if("string"==typeof n)e.style.cssText=n;else{for(var i in"string"==typeof t&&(e.style.cssText=""),n)e.style[i]=n[i];if(null!=t&&"string"!=typeof t)for(var i in t)i in n||(e.style[i]="")}}(s,n,a);else if(t in s&&"href"!==(o=t)&&"list"!==o&&"form"!==o&&"width"!==o&&"height"!==o&&void 0===r&&!function(e){return e.attrs.is||e.tag.indexOf("-")>-1}(e)){if("input"===e.tag&&"value"===t&&e.dom.value==a&&e.dom===i.activeElement)return;if("select"===e.tag&&"value"===t&&e.dom.value==a&&e.dom===i.activeElement)return;if("option"===e.tag&&"value"===t&&e.dom.value==a)return;if("input"===e.tag&&"type"===t)return void s.setAttribute(t,a);s[t]=a}else"boolean"==typeof a?a?s.setAttribute(t,""):s.removeAttribute(t):s.setAttribute("className"===t?"class":t,a)}}function w(e){return"oninit"===e||"oncreate"===e||"onupdate"===e||"onremove"===e||"onbeforeremove"===e||"onbeforeupdate"===e}function x(e,t,i){var a=e.dom,r="function"!=typeof n?i:function(e){var t=i.call(a,e);return n.call(a,e),t};if(t in a)a[t]="function"==typeof i?r:null;else{var s=t.slice(2);if(void 0===e.events&&(e.events={}),e.events[t]===r)return;null!=e.events[t]&&a.removeEventListener(s,e.events[t],!1),"function"==typeof i&&(e.events[t]=r,a.addEventListener(s,e.events[t],!1))}}function k(e,t,n){"function"==typeof e.oninit&&e.oninit.call(t.state,t),"function"==typeof e.oncreate&&n.push(e.oncreate.bind(t.state,t))}function I(e,t,n){"function"==typeof e.onupdate&&n.push(e.onupdate.bind(t.state,t))}return{render:function(t,n){if(!t)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var a=[],r=i.activeElement;null==t.vnodes&&(t.textContent=""),Array.isArray(n)||(n=[n]),l(t,t.vnodes,e.normalizeChildren(n),!1,a,null,void 0),t.vnodes=n;for(var s=0;s<a.length;s++)a[s]();i.activeElement!==r&&r.focus()},setEventCallback:function(e){return n=e}}},h=function(e){var t=p(e);t.setEventCallback((function(e){!1!==e.redraw&&a()}));var n=[];function i(e){var t=n.indexOf(e);t>-1&&n.splice(t,2)}function a(){for(var e=1;e<n.length;e+=2)n[e]()}return{subscribe:function(e,t){i(e),n.push(e,function(e){var t=0,n=null,i="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var a=Date.now();0===t||a-t>=16?(t=a,e()):null===n&&(n=i((function(){n=null,e(),t=Date.now()}),16-(a-t)))}}(t))},unsubscribe:i,redraw:a,render:t.render}}(window);f.setCompletionCallback(h.redraw),l.mount=(d=h,function(t,n){if(null===n)return d.render(t,[]),void d.unsubscribe(t);if(null==n.view&&"function"!=typeof n)throw new Error("m.mount(element, component) expects a component, not a vnode");d.subscribe(t,(function(){d.render(t,e(n))})),d.redraw()});var v=u,b=function(e){if(""===e||null==e)return{};"?"===e.charAt(0)&&(e=e.slice(1));for(var t=e.split("&"),n={},i={},a=0;a<t.length;a++){var r=t[a].split("="),s=decodeURIComponent(r[0]),o=2===r.length?decodeURIComponent(r[1]):"";"true"===o?o=!0:"false"===o&&(o=!1);var c=s.split(/\]\[?|\[/),l=n;s.indexOf("[")>-1&&c.pop();for(var u=0;u<c.length;u++){var d=c[u],m=c[u+1],g=""==m||!isNaN(parseInt(m,10)),f=u===c.length-1;""===d&&(null==i[s=c.slice(0,u).join()]&&(i[s]=0),d=i[s]++),null==l[d]&&(l[d]=f?o:g?[]:{}),l=l[d]}}return n},y=function(e){var t,n="function"==typeof e.history.pushState,i="function"==typeof setImmediate?setImmediate:setTimeout;function a(t){var n=e.location[t].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===t&&"/"!==n[0]&&(n="/"+n),n}function r(e,t,n){var i=e.indexOf("?"),a=e.indexOf("#"),r=i>-1?i:a>-1?a:e.length;if(i>-1){var s=a>-1?a:e.length,o=b(e.slice(i+1,s));for(var c in o)t[c]=o[c]}if(a>-1){var l=b(e.slice(a+1));for(var c in l)n[c]=l[c]}return e.slice(0,r)}var s={prefix:"#!",getPath:function(){switch(s.prefix.charAt(0)){case"#":return a("hash").slice(s.prefix.length);case"?":return a("search").slice(s.prefix.length)+a("hash");default:return a("pathname").slice(s.prefix.length)+a("search")+a("hash")}},setPath:function(t,i,a){var o={},c={};if(t=r(t,o,c),null!=i){for(var l in i)o[l]=i[l];t=t.replace(/:([^\/]+)/g,(function(e,t){return delete o[t],i[t]}))}var u=m(o);u&&(t+="?"+u);var d=m(c);if(d&&(t+="#"+d),n){var g=a?a.state:null,f=a?a.title:null;e.onpopstate(),a&&a.replace?e.history.replaceState(g,f,s.prefix+t):e.history.pushState(g,f,s.prefix+t)}else e.location.href=s.prefix+t},defineRoutes:function(a,o,c){function l(){var t=s.getPath(),n={},i=r(t,n,n),l=e.history.state;if(null!=l)for(var u in l)n[u]=l[u];for(var d in a){var m=new RegExp("^"+d.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(m.test(i))return void i.replace(m,(function(){for(var e=d.match(/:[^\/]+/g)||[],i=[].slice.call(arguments,1,-2),r=0;r<e.length;r++)n[e[r].replace(/:|\./g,"")]=decodeURIComponent(i[r]);o(a[d],n,t,d)}))}c(t,n)}var u;n?e.onpopstate=(u=l,function(){null==t&&(t=i((function(){t=null,u()})))}):"#"===s.prefix.charAt(0)&&(e.onhashchange=l),l()}};return s};l.route=function(t,n){var i,a,r,s,o,c=y(t),l=function(e){return e},u=function(t,u,d){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var m=function(){null!=i&&n.render(t,i(e(a,r.key,r)))},g=function(e){if(e===u)throw new Error("Could not resolve default route "+u);c.setPath(u,null,{replace:!0})};c.defineRoutes(d,(function(e,t,n){var c=o=function(e,u){c===o&&(a=null==u||"function"!=typeof u.view&&"function"!=typeof u?"div":u,r=t,s=n,o=null,i=(e.render||l).bind(e),m())};e.view||"function"==typeof e?c({},e):e.onmatch?v.resolve(e.onmatch(t,n)).then((function(t){c(e,t)}),g):c(e,"div")}),g),n.subscribe(t,m)};return u.set=function(e,t,n){null!=o&&(n={replace:!0}),o=null,c.setPath(e,t,n)},u.get=function(){return s},u.prefix=function(e){c.prefix=e},u.link=function(e){e.dom.setAttribute("href",c.prefix+e.attrs.href),e.dom.onclick=function(e){if(!(e.ctrlKey||e.metaKey||e.shiftKey||2===e.which)){e.preventDefault(),e.redraw=!1;var t=this.getAttribute("href");0===t.indexOf(c.prefix)&&(t=t.slice(c.prefix.length)),u.set(t,void 0,void 0)}}},u.param=function(e){return void 0!==r&&void 0!==e?r[e]:r},u}(window,h),l.withAttr=function(e,t,n){return function(i){t.call(n||this,e in i.currentTarget?i.currentTarget[e]:i.currentTarget.getAttribute(e))}};var _=p(window);l.render=_.render,l.redraw=h.redraw,l.request=f.request,l.jsonp=f.jsonp,l.parseQueryString=b,l.buildQueryString=m,l.version="1.1.1",l.vnode=e,i.exports=l}();var r=n(a.exports),s={};function o(e){return"string"==typeof e&&(e=e.split(".")),e}s.set=function(e,t,n){let i,a=e;const r=(t=o(t)).length-1;if(r>=0){for(i=0;i<r;i++)t[i]in a||(a[t[i]]={}),a=a[t[i]];a[t[i]]=n}return e};var c=s.get=function(e,t){if("object"!=typeof e)return;const n=(t=o(t)).length;for(let i=0;null!=e&&i<n;i++)e=e[t[i]];return e};function l(t){return Boolean(e.stats.features?.[t]?.current)}function u(){const t=GW2.config.features,n="Steam"===e.stats.provider,i="Epic"===e.stats.provider;let a="full";return c(e.stats.features,["2","current"])||(a="free"),e.player.isEconomyRestricted&&(a="restricted"),{status:a,expansions:{starter_pack_specifically:l(91),starter_pack:l(45)||l(64)||l(58)||l(65)||l(72)||l(78)||l(85)||l(91)||l(46)||l(62)||l(70)||l(76)||l(82)||l(89),hot:l(45)||l(64),expac1Deluxe:l(46),hot_dd:l(46),hotUltimate:l(47),expac2:l(58),pof:l(58),expac2Deluxe:l(62),pof_dd:l(62),expac3:l(65),eod:l(65),expac3Deluxe:l(70),eod_dd:l(70),expac4:l(72),soto:l(72),expac4Deluxe:l(76),soto_dd:l(76),expac5:l(78),jw:l(78),expac5Deluxe:l(82),jw_dd:l(82),expac6:l(85),voe:l(85),expac6Deluxe:l(89),voe_dd:l(89)},check:e=>Boolean(t[e])&&("full"===a||Boolean(t[`${e}-${a}`]))&&(!n||Boolean(t[`${e}-steam`]))&&(!i||Boolean(t[`${e}-epic`])),tooltip(n){const i=window.Exchange.i18n.disabled;return n in t&&!t[n]?i.feature:"restricted"===a?e.stats.tScore?i.free:i.untrusted:i[a]}}}s.merge=function(){const e=arguments.length,t={};for(let n=0;n<e;n++){const e=arguments[n];for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}return t},s.each=function(e,t){let n=0;for(const i in e)e.hasOwnProperty(i)&&t(e[i],i,n++)};const d={};function m(t){return d[t]||(d[t]=e.import(t)),d[t]}var g=function(e){return e instanceof Date},f=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4},p=g,h=/[T ]/,v=/:/,b=/^(\d{2})$/,y=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],_=/^(\d{4})/,w=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],x=/^-(\d{2})$/,k=/^-?(\d{3})$/,I=/^-?(\d{2})-?(\d{2})$/,T=/^-?W(\d{2})$/,C=/^-?W(\d{2})-?(\d{1})$/,P=/^(\d{2}([.,]\d*)?)$/,S=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,$=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,E=/([Z+-].*)$/,D=/^(Z)$/,O=/^([+-])(\d{2})$/,A=/^([+-])(\d{2}):?(\d{2})$/;function L(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var a=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+a),i}var G=function(e,t){if(p(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?2:Number(n);var i=function(e){var t,n={},i=e.split(h);v.test(i[0])?(n.date=null,t=i[0]):(n.date=i[0],t=i[1]);if(t){var a=E.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),a=function(e,t){var n,i=y[t],a=w[t];if(n=_.exec(e)||a.exec(e)){var r=n[1];return{year:parseInt(r,10),restDateString:e.slice(r.length)}}if(n=b.exec(e)||i.exec(e)){var s=n[1];return{year:100*parseInt(s,10),restDateString:e.slice(s.length)}}return{year:null}}(i.date,n),r=a.year,s=function(e,t){if(null===t)return null;var n,i,a;if(0===e.length)return(i=new Date(0)).setUTCFullYear(t),i;if(n=x.exec(e))return i=new Date(0),a=parseInt(n[1],10)-1,i.setUTCFullYear(t,a),i;if(n=k.exec(e)){i=new Date(0);var r=parseInt(n[1],10);return i.setUTCFullYear(t,0,r),i}if(n=I.exec(e)){i=new Date(0),a=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return i.setUTCFullYear(t,a,s),i}if(n=T.exec(e))return L(t,parseInt(n[1],10)-1);if(n=C.exec(e)){return L(t,parseInt(n[1],10)-1,parseInt(n[2],10)-1)}return null}(a.restDateString,r);if(s){var o,c=s.getTime(),l=0;if(i.time&&(l=function(e){var t;if(t=P.exec(e))return parseFloat(t[1].replace(",","."))%24*36e5;if(t=S.exec(e))return parseInt(t[1],10)%24*36e5+6e4*parseFloat(t[2].replace(",","."));if(t=$.exec(e)){return parseInt(t[1],10)%24*36e5+6e4*parseInt(t[2],10)+1e3*parseFloat(t[3].replace(",","."))}return null}(i.time)),i.timezone)o=6e4*function(e){var t,n;if(t=D.exec(e))return 0;if(t=O.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=A.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(i.timezone);else{var u=c+l,d=new Date(u);o=f(d);var m=new Date(u);m.setDate(d.getDate()+1);var g=f(m)-f(d);g>0&&(o+=g)}return new Date(c+l+o)}return new Date(e)},q=G;var R=function(e,t){var n=q(e),i=q(t);return n.getTime()<i.getTime()},M=n(R);const F=Date.now();let N=0;function H(){return N+Date.now()-F}var B=(e,t,n)=>{const i={};let a=H();return a=a?new Date(a):new Date,e.filter((e=>{const r=e.id||e;let s=t&&t[r];if(!s)return!0;if(Array.isArray(s)||(s=[s]),n&&n.ignoreOrder)return s.some((e=>e&&M(e.start,a)&&M(a,e.end)));i[r]=i[r]?i[r]+1:1;const o=s[i[r]-1];return o&&M(o.start,a)&&M(a,o.end)}))};const j=window.gemstoreCategories,U=Object.keys(j),z={Featured_NAEU:"featured",Featured:"featured",Featured_China:"featuredChina","New Items":"new","Ending Soon":"expiring",Discounts:"sale","Gold Exchange":"exchange"};let W=!1;function Y(e,t){return e.push(t),j[t].childCategories.length?j[t].childCategories.map((e=>e.id||e)).reduce(Y,e):e}function Q(){U.forEach((e=>{j[e].children=j[e].childCategories.map((e=>e.id)).reduce(Y,[e])}))}function V(e,t){let n;if(!e)return!1;if("root"===e.name.toLowerCase())return t.slice(1);if("promotions"===e.name.toLowerCase())return t;for(const i of e.parentCategories)if(n=V(i,[i.id].concat(t)),n)break;return n}function K(e,t,n){e.hasItems=n||t[e.id],e.hasItems&&e.parentCategories.forEach((e=>K(e,t,!0)))}function X(e){(e=j[e]).featuredItems=B(e.unfilteredFeaturedItems,e.featuredItemLifespan),e.childCategories=B(e.unfilteredChildCategories,e.childLifespans)}function J(e){return V(j[e],[e])||null}function Z(){const e={};Object.keys(ke.catalog).forEach((t=>{const n=ke.catalog[t];se(n)&&n.categories.forEach((t=>e[t]=!0))})),U.forEach(X),W||(Q(),W=!0),U.forEach((t=>K(j[t],e)))}U.forEach((e=>{const t=j[e];t.id=e,t.parentCategories=t.parentCategories.map((e=>j[e])),t.childCategories=t.childCategories.map((e=>j[e])),t.unfilteredChildCategories=t.childCategories,t.unfilteredFeaturedItems=t.featuredItems,"Root"===t.name&&(j.root=t),0===t.name.indexOf("BaseCategory_")&&(t.name=t.name.replace("BaseCategory_","").toLowerCase(),j[t.name]=t),"exchange"===z[t.name]&&(t.isExchange=!0),z[t.name]&&(j[z[t.name]]=t)})),U.forEach(X),Q();const ee=GW2.imageBase;function te(e){const t=`${ee}/${e.imageHash||"44e4c6dd"}`;return{large:`${t}_large.png`,splash:`${t}_splash.jpg`}}function ne(e,t){return e&&t&&(e=new Date(9999999999999-e.getTime())),(e||new Date(9999999999999)).toISOString()}function ie(e,t){const n=parseInt(e.quantity&&e.quantity.percent_off,10),i=j[t]?j[t].featuredItems.indexOf(e.guid):-1;let a="";return a=String.fromCharCode(e.disabled?65535:1),a+=String.fromCharCode(-1===i?65535:1),a+=ne(n&&e.expireTime),a+=ne(!n&&e.expireTime),a+=String.fromCharCode(n&&n>=40?1:65535),a+=ne(e.new&&e.start,!0),a+=ne(e.returning&&e.start,!0),a+=String.fromCharCode(n&&n<40?1:65535),a+=ne(e.expiring&&!e.expireTime&&e.end),a+=String.fromCharCode(-1!==i?i:65535),a+=e.name,a}function ae(e,t,n){let i;return"string"==typeof e&&(i=e,e=t,t=n),ie(t,i)<ie(e,i)?1:-1}function re(t){const n={},i=window.gemstoreIndex.index,a=window.gemstoreIndex.guids;let r;function o(e,t,i){e&&(e[1].forEach((e=>{e[1].forEach((r=>{const s=a[r];n[s]=(n[s]||0)+e[0]*(t/(i+1))}))})),s.each(e[0],(e=>o(e,t,i+1))))}return r="zh"===e.stats.language?(t=t.toLowerCase()).split(""):(t=t.toLowerCase().replace(/\W\s/g,"")).match(/(?!'.*')\b[\w']+\b/g)||[],r.forEach((e=>{let t=[i,[]];if(0!==e.length){for(let n=0;n<e.length;n++)t&&(t=t[0][e[n]]);o(t,e.length,e.length-1)}})),Object.keys(n).sort(((e,t)=>n[e]!==n[t]?n[t]-n[e]:ae(me(e),me(t))))}function se(e,t){return!(!e||e.soldOut||e.hide&&!t)}function oe(e,t){const n=s.merge(e),i=Object.keys(n),a=Boolean("text"in n&&n.text.length),r=Array.isArray(n.category)&&n.category.length&&n.category.slice(-1)[0];let o;return n.package?[ke.catalog[n.package]]:(n.text?(o=re(n.text),delete n.text):o=Object.keys(ke.catalog),o=o.filter((e=>{const t=ke.catalog[e];return!!se(t)&&i.every((e=>{const i=n[e];return"tag"===e?t.tags[i]:"category"===e?!!t.categories.length&&(!r||function(e,t){return!!(e&&t.categories.length&&j[e])&&t.categories.some((t=>j[e].children.indexOf(t)>-1))}([r],t)):t[e]===i}))})).map((e=>ke.catalog[e])),a||t||(o.sort(ae),r&&o.sort(ae.bind(o,r))),o)}function ce(e){let t=e.tags.splash.start?-Date.parse(e.tags.splash.start):1e13;return 0===e.callout.type.indexOf("ending")&&(t-=3e13),"sale"===e.callout.type&&(t-=2e13),e.disabled&&(t=1/0),t}function le(){return oe({},!0).slice(0,20).sort(((e,t)=>e.position-t.position))}function ue(e,t){return e.filter((e=>t.every((t=>e.guid!==t.guid))))}function de(){const t=ke.onHome(),n=-1!==["gw2cn","gw2-mdv"].indexOf(e.buildInfo.gameCode)&&j.featuredChina?"featuredChina":"featured",i=j[n]?j[n].childCategories.slice(0,5):[];let a;if(t||ke.banner){const e=[],t=new Date(H());s.each(window.gemstoreCatalog,((n,i)=>{"banner"===n.type&&(n.availableDate&&M(t,n.availableDate)||n.removeDate&&M(n.removeDate,t)||(n.guid=i,n.tags={splash:{start:n.availableDate}},n.images=te(n),n.callout={type:"none"},e.push(n)))})),ke.carouselResults=oe({tag:"splash"}).concat(e).sort(((e,t)=>ce(e)-ce(t)))}if(t)return a={},i.push({id:"recommended",displayname:window.gemstore_strings.recommendedCat}),void(ke.featuredResults=i.map((e=>{const t=[];return oe("recommended"===e.id?{}:{category:[e.id]}).some((e=>!(e.guid in a)&&(t.push(e),a[e.guid]=!0,3===t.length))),{category:e,items:t}})).filter((e=>e.items.length>0)).slice(0,3));ke.searchResults=oe(ke.search),ke.extraResults=[],ke.searchResults.length<7&&ke.search.text&&ke.search.category&&(ke.extraResults=ue(oe(s.merge(ke.search,{category:[]})),ke.searchResults),ke.extraRecsOnly=ke.extraResults.length<=0,ke.extraResults=ke.extraResults.concat(ue(le(),ke.extraResults.concat(ke.searchResults))).slice(0,10)),0===ke.searchResults.length&&(ke.noResultsFiller=ke.extraResults.length?ke.extraResults:le(),ke.resultsChanged=!1)}function me(e){return ke.catalog[e]||window.gemstoreCatalog[e]}var ge=Object.freeze({NATIVE:"native",PAPERDOLL:"paperdoll",GALLERY:"gallery",NONE:"",isValid(e){return Object.values(this).includes(e)}});const fe=m("gw2/ui/paperdoll");function pe(){fe.then((e=>e.show()))}function he(){fe.then((e=>e.hide()))}function ve(){return fe.then((e=>{e.create(null,{x0:492,y0:22,x1:945,y1:533})}))}function be(e){let t;t=e.isPackage?e.included.map((e=>{const t=me(e.guid);return!(!t.previewable||!1!==t.nativePreviewable||e.disablePreview)&&t.dataId})).filter(Boolean):[e.dataId],fe.then((e=>t.forEach((t=>e.previewItem(t)))))}function ye(){fe.then((e=>e.destroy()))}function _e(){return ke.previewType===ge.PAPERDOLL}function we(){return new Promise((e=>setTimeout(e,200)))}async function xe(t,n){e.call("HideTextTooltip");const i=ke.guidToPreviewType.get(t.guid);if(i&&!(ke.onHome()&&t.categories.length<1))switch(n&&setTimeout((()=>{n.scrollIntoView({behavior:"smooth",block:"nearest"})}),0),i){case ge.NATIVE:ke.closePreview(),be(t);break;case ge.PAPERDOLL:ke.previewType?ke.previewType!==ge.PAPERDOLL&&(ke.previewGalleryItem=null,ke.previewType=ge.PAPERDOLL,await ve()):(ke.previewType=ge.PAPERDOLL,await we(),await ve()),be(t);break;case ge.GALLERY:ke.previewType?ke.previewType!==ge.GALLERY&&(ke.previewType=ge.GALLERY,ye()):(ke.previewType=ge.GALLERY,await we()),ke.previewGalleryItem=t;break;default:ke.closePreview()}}const ke={showingCached:!1,history:[],purchases:[],catalog:{},popup:!1,popupClassname:null,timePicker:!1,inPackage:[],packageItemToPackages:new Map,search:{},searchResults:[],carouselResults:[],featuredResults:[],extraResults:[],resultsChanged:!0,clickedItem:null,carousel:{index:0,prevIndex:0},purchase:{info:!1,inProgress:!1,success:!1},noResultsFiller:[],guidToPreviewType:new Map,isPreviewable:e=>Boolean(ke.guidToPreviewType.get(e)),firstLoadPreviewGuid:null,guidToIsUnlocked:new Map,isUnlocked:e=>ke.guidToIsUnlocked.get(e),guidToPartiallyUnlocked:new Map,isPartiallyUnlocked:e=>ke.guidToPartiallyUnlocked.get(e),_previewType:null,get previewType(){return this._previewType},set previewType(e){ge.isValid(e)?ke._previewType=e:ke._previewType=void 0},_previewGalleryItem:null,get previewGalleryItem(){return this._previewGalleryItem},set previewGalleryItem(e){ke._previewGalleryItem=e||void 0},flyout:null,flyoutResults:null,gifting:{contacts:[],order:{},success:!1,failure:!1},exchange:{gold:"",gems:""},openBuyGems:!1,upsell:{name:null,guid:null}},Ie=r.route.set;function Te(t,n){return t.headers||(t.headers={}),t.type||(t.type="One"),t.protocol=t.protocol.replace(".gw2.",`.${e.buildInfo.gameCode}.`),GW2.config.features.cliGate?function(t,n){return t.body=JSON.stringify(t.body||{}),t.headers.c="application/json",e.call("StsRequest",t).then((e=>e.bodyRaw?JSON.parse(e.bodyRaw):e)).catch((e=>{const t=new Error("STS Error");throw n&&n.errorCode&&(t.code=e.code),t}))}(t,n):function(t){return t.headers.m=e.stats.sessionId,t.stubbed=e.stubbed,r.request({method:"POST",url:`/stsRequest?${t.protocol}/${t.command}`,headers:{},data:t,background:!0}).then((e=>e.body))}(t)}function Ce(){return Te({protocol:"Game.gw2.Exchange",command:"GetInverseQuote",body:{Type:"ReceivingCoins",Quantity:1e4*GW2.config.exchangeGold}}).then((function(e){ke.exchange.gems!==e.quantity&&r.redraw(),ke.exchange.gems=e.quantity,ke.exchange.gold=GW2.config.exchangeGold}))}r.route.set=function(e,t){t||ke.push(e),Ie(e)},ke.setFlyout=function(e){ke.flyout=e,e&&he(),e||!ke.previewType||ke.purchase.info||ke.popup||pe()},ke.onHistory=function(){const e=r.route.get()||document.location.pathname;return"/history"===e||0===e.indexOf("/history?")},ke.onHome=function(){const e=r.route.get()||document.location.pathname;return"/"===e||0===e.indexOf("/?")},ke.showPopup=function(t,n){he(),e.call("HideTextTooltip"),ke.popup=t,ke.popupClassname=n},ke.hidePopup=function(){ke.popup=!1,ke.popupClassname=null,ke.previewType===ge.PAPERDOLL&&requestAnimationFrame(pe)},ke.goToCategory=e=>{const t=J(e.categories[0]);r.route.set(`/category/${t.join("/")}`)},ke.highlightItem=(e,t,n)=>{let i,a=t;if(!e)return null;e.gemStoreBannerItem&&(e=ke.catalog[e.gemStoreBannerItem]);const s=n?`&${r.buildQueryString(n)}`:"";return Array.isArray(t)||(a=window.gemstoreCategories[t]&&J(t)?J(t):[e.categories.some((e=>!!J(e)&&(i=e,!0)))&&J(i)[0]]),ke.isPreviewable(e.guid)&&xe(e),e.isPackage?r.route.set(`/item/${e.guid}?categories=${a.join(",")}${s}`):e.hide&&ke.packageItemToPackages.has(e.guid)?r.route.set(`/item/${ke.packageItemToPackages.get(e.guid)[0]}?categories=${a.join(",")}${s}`):r.route.set(`/category/${a.join("/")}?guid=${e.guid}${s}`)},ke.push=()=>{ke.history.push(document.location.href),ke.history=ke.history.slice(-20)},ke.pop=()=>{if(ke.history.length){const e=new URL(ke.history.pop()),t=r.parseQueryString(e.search);ke.search.package&&(t.guid=ke.search.package,e.search=`?${r.buildQueryString(t)}`);const n=e.toString().split("#!")[1];r.route.set(n,!0)}},ke.isSteamUser=()=>"Steam"===e.stats.provider,ke.isEpicUser=()=>"Epic"===e.stats.provider,ke.is3rdParty=()=>"Portal"!==e.stats.provider,ke.closePreview=()=>{ye(),ke.previewGalleryItem=void 0,ke.previewType=void 0};var Pe={},Se={};!function(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"};function n(e){return t[e]}e.html=function(e){return`${e}`.replace(/[&<>"'\/`]/g,n)},e.regex=function(e){return`${e}`.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")},e.regexp=e.regex}(Se),function(e){const t=s,n=Se,i=/\{\s*([^\|\}]+?)\s*(?:\|([^\}]*))?\s*\}/g;function a(n,i){const a=[];i=t.merge(e.options,i);return`data || (data = {});var $b='', $v=function(v){return v || v === 0 ? v : $b;}, $t='${`${n}`.replace(/\ufffe|\uffff/g,"").replace(i.rawOutput,(function(e,t){return"\ufffe"+(a.push(`'+\n$v(${t})+\n'`)-1)+"\uffff"})).replace(i.escapedOutput,(function(e,t){return"\ufffe"+(a.push(`'+\n$e($v(${t}))+\n'`)-1)+"\uffff"})).replace(i.code,(function(e,t){return"\ufffe"+(a.push(`';\n${t}\n$t+='`)-1)+"\uffff"})).replace(i.stringEscape,(function(e){return i.stringReplace[e]||""})).replace(/\ufffe(\d+)\uffff/g,(function(e,t){return a[parseInt(t,10)]})).replace(/\n\$t\+='';\n/g,"\n")}';\nreturn $t;`}e._compile=a,e.compile=function(e,t){const i=a(e,t);return new Function("$e","data",i).bind(null,n.html)},e.options={code:/<%([\s\S]+?)%>/g,escapedOutput:/<%=([\s\S]+?)%>/g,rawOutput:/<%==([\s\S]+?)%>/g,stringEscape:/\\|'|\r|\n|\t|\u2028|\u2029/g,stringReplace:{"\\":"\\\\","'":"\\'","\r":"\\r","\n":"\\n","\t":"\\t","\u2028":"\\u2028","\u2029":"\\u2029"}},e.sub=function(e,n){return e.replace&&"object"==typeof n?e.replace(i,(function(e,i){let a;return i.indexOf(".")>-1?(a=t.get(n,i),void 0!==a?a:e):void 0!==n[i]?n[i]:e})):e}}(Pe);var $e=n(Pe);function Ee(t){return`${$e.sub(t,{lang:e.stats.language})}:${e.player.portalUserId}`}function De(e){const t=localStorage.getItem(Ee(e));return!(!t||"undefined"===t)&&JSON.parse(t)}function Oe(e,t){localStorage.setItem(Ee(e),JSON.stringify(t))}const Ae={gotPersisted:!1,mustHave:{}};function Le(){e.import("gw2/datastore").then((e=>{e.store("mustHave",Ae.mustHave,{persist:!0})}))}function Ge(e){const t=Ae.mustHave[e];return!Ae.gotPersisted||(t?new Date(t).getTime()>H():void 0)}window.clearSuppressed=function(){Ae.mustHave={},Le()};const qe=GW2.config.upsells||{},Re={gem_store_item_id:"",hide:!0,start:"2025-01-01T00:00:00Z",tags:[],required_features:[],excluded_features:[],listings:[{quantity:"1",start:"2025-01-01T00:00:00Z",discount:"0",discount_pct:"10000",base_price:1e4,discount_price:1e4,vip_base_price:9e3,vip_discount_price:9e3,count:1,discount_type:0,account_limit:null,account_remaining:null,bundle_price:null,total_limit:null,total_remaining:null,price:1e4}],position:100};let Me;function Fe(e){return 1===Number(e?.listings?.[0]?.discount)}function Ne(){const t=[Te({protocol:"Game.gw2.GemStore",command:"GetCatalog",body:{Time:GemStore.gsOverrideTime,BuildId:e.buildInfo.id||0,LastUpdate:GW2.config.features.catalogDeltas&&(De("lastUpdate:{lang}")||void 0)}})],n=Object.keys(qe).filter((e=>!e.includes("_dd"))).filter((e=>!u().expansions[e]));return n?.length&&t.push(Me?Promise.resolve(Me):fetch(`/ws/upgrades?provider=${e.stats.provider}`).then((e=>e.json())).then((e=>!(!e||"object"!=typeof e)&&(Me=e,Me))).catch((()=>!1))),Promise.all(t).then((([e,t])=>{var i,a;return e.delta="is_delta"in e,Oe("lastUpdate:{lang}",e.last_update),a=n,e=(i=e)?.items?.length?(a.map((e=>qe[e])).filter((e=>!i.items.find((t=>t.gem_store_item_id===e.guid)))).forEach((e=>{const t=Re;t.gem_store_item_id=e.guid,i.items.push(t)})),i):i,t&&(e=function(e,t){return e?.items?.length?(t.map((e=>qe[e])).map((e=>e.guid)).map((t=>e.items.find((e=>e.gem_store_item_id===t)))).filter((e=>e?.listings?.[0])).filter(Boolean).forEach((e=>{e.listings[0].discount="1"})),e):e}(e,Object.keys(t))),(!e.delta||e.delta&&e.items.length>0)&&function(e){const t=(!!e.delta&&De("gsCatalog:{lang}")).items||{};e.items.forEach(((n,i)=>{e.delta?n.position=t[n.gem_store_item_id]?t[n.gem_store_item_id].position:1e3:n.position=i,t[n.gem_store_item_id]=n})),e.items=t,Oe("gsCatalog:{lang}",e)}(e),e.delta||(ke.group=e.test_group_guid),ke.showingCached=!1,e}),(t=>{t&&t instanceof Object&&"code"in t&&"product"in t&&"module"in t&&"line"in t&&e.call("ShowNetErrorBasic",t.code,t.product,t.module,t.line)}))}e.import("gw2/datastore").then((e=>{e.prepare().then((()=>{Ae.gotPersisted=!0,Ae.mustHave=s.merge(Ae.mustHave,e.mustHave)}))}));var He=G;var Be=function(e,t){var n=He(e),i=Number(t);return n.setDate(n.getDate()+i),n},je=n(Be);const Ue=["account_limit","account_remaining","base_price","bundle_price","count","discount_price","discount_type","total_limit","total_remaining","vip_base_price","vip_discount_price"];function ze(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}var We=G;var Ye=function(e){var t=We(e);return t.setHours(0,0,0,0),t},Qe=Ye;var Ve=function(e,t){var n=Qe(e),i=Qe(t),a=n.getTime()-6e4*n.getTimezoneOffset(),r=i.getTime()-6e4*i.getTimezoneOffset();return Math.round((a-r)/864e5)},Ke=G;var Xe=G,Je=Ve,Ze=function(e,t){var n=Ke(e).getTime(),i=Ke(t).getTime();return n<i?-1:n>i?1:0};var et=n((function(e,t){var n=Xe(e),i=Xe(t),a=Ze(n,i),r=Math.abs(Je(n,i));return n.setDate(n.getDate()-a*r),a*(r-(Ze(n,i)===-a))})),tt=G;var nt=function(e){var t=tt(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n},it=G,at=nt,rt=Ve;var st=function(e){var t=it(e);return rt(t,at(t))+1},ot=G;var ct=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=ot(e),a=i.getDay(),r=(a<n?7:0)+a-n;return i.setDate(i.getDate()-r),i.setHours(0,0,0,0),i},lt=ct;var ut=function(e){return lt(e,{weekStartsOn:1})},dt=G,mt=ut;var gt=function(e){var t=dt(e),n=t.getFullYear(),i=new Date(0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);var a=mt(i),r=new Date(0);r.setFullYear(n,0,4),r.setHours(0,0,0,0);var s=mt(r);return t.getTime()>=a.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1},ft=gt,pt=ut;var ht=G,vt=ut,bt=function(e){var t=ft(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),pt(n)};var yt=function(e){var t=ht(e),n=vt(t).getTime()-bt(t).getTime();return Math.round(n/6048e5)+1},_t=g;var wt=function(e){if(_t(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")};var xt=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];var kt=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);var i=xt.concat(t).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")},It=kt;var Tt=function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["AM","PM"],s=["am","pm"],o=["a.m.","p.m."],c={MMM:function(t){return e[t.getMonth()]},MMMM:function(e){return t[e.getMonth()]},dd:function(e){return n[e.getDay()]},ddd:function(e){return i[e.getDay()]},dddd:function(e){return a[e.getDay()]},A:function(e){return e.getHours()/12>=1?r[1]:r[0]},a:function(e){return e.getHours()/12>=1?s[1]:s[0]},aa:function(e){return e.getHours()/12>=1?o[1]:o[0]}};return["M","D","DDD","d","Q","W"].forEach((function(e){c[e+"o"]=function(t,n){return function(e){var t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(n[e](t))}})),{formatters:c,formattingTokensRegExp:It(c)}},Ct=Tt,Pt={distanceInWords:function(){var e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(t,n,i){var a;return i=i||{},a="string"==typeof e[t]?e[t]:1===n?e[t].one:e[t].other.replace("{{count}}",n),i.addSuffix?i.comparison>0?"in "+a:a+" ago":a}}}(),format:Ct()},St=st,$t=yt,Et=gt,Dt=G,Ot=wt,At=Pt;var Lt={M:function(e){return e.getMonth()+1},MM:function(e){return Rt(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return Rt(e.getDate(),2)},DDD:function(e){return St(e)},DDDD:function(e){return Rt(St(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return $t(e)},WW:function(e){return Rt($t(e),2)},YY:function(e){return Rt(e.getFullYear(),4).substr(2)},YYYY:function(e){return Rt(e.getFullYear(),4)},GG:function(e){return String(Et(e)).substr(2)},GGGG:function(e){return Et(e)},H:function(e){return e.getHours()},HH:function(e){return Rt(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:t>12?t%12:t},hh:function(e){return Rt(Lt.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return Rt(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return Rt(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return Rt(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return Rt(e.getMilliseconds(),3)},Z:function(e){return qt(e.getTimezoneOffset(),":")},ZZ:function(e){return qt(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function Gt(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function qt(e,t){t=t||"";var n=e>0?"-":"+",i=Math.abs(e),a=i%60;return n+Rt(Math.floor(i/60),2)+t+Rt(a,2)}function Rt(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}var Mt=function(e,t,n){var i=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",a=(n||{}).locale,r=At.format.formatters,s=At.format.formattingTokensRegExp;a&&a.format&&a.format.formatters&&(r=a.format.formatters,a.format.formattingTokensRegExp&&(s=a.format.formattingTokensRegExp));var o=Dt(e);if(!Ot(o))return"Invalid Date";var c=function(e,t,n){var i,a,r=e.match(n),s=r.length;for(i=0;i<s;i++)a=t[r[i]]||Lt[r[i]],r[i]=a||Gt(r[i]);return function(e){for(var t="",n=0;n<s;n++)r[n]instanceof Function?t+=r[n](e,Lt):t+=r[n];return t}}(i,r,s);return c(o)},Ft=n(Mt);const Nt=$e.sub,Ht=window.gemstore_strings.items.item.callouts;function Bt(e){const t=function(e){const t=e.quantity,n=t.percent_off,i="100"===n||100===n,a=new Date(H());let r;if(e.tags.musthave&&!Ge(e.gem_store_item_id)&&(r="mustHave"),e.missingFeatures)return{type:r||"locked",details:e.requirementMissing||window.gemstore_strings.items.item.features};if(t.total_remaining){const e=ke.banner?Ht.saleendingshort:Ht.saleending;return{type:r||"endingLimit",text:i?Ht.freeEnding:e,details:Nt(Ht[n?"quantityleftsale":"quantityleft"],{quantity:t.total_remaining})}}if(e.expireTime){const t=ke.banner?Ht.saleendingshort:Ht.saleending;return{type:r||"endingTime",text:i?Ht.freeEnding:t,endTime:e.expireTime,getDetails:function(){const t=Date.parse(e.expireTime)-H();return Nt(Ht[n?"timeleftsale":"timeleft"],{time:Ft(new Date(Date.parse("1-1-2016")+Math.max(t,0)),"HH:mm:ss")})}}}if(n){const e=i?Ht.free:Nt(Ht.percentOff,{sale:n});return{type:r||"sale",details:Ht.limitedtime,text:e}}return e.expiring?{type:r||"expiring",text:Nt(ke.banner?Ht.daysleft:Ht.daysavailable,{days:et(e.end,a)+1})}:e.new?{type:r||(e.returning?"returning":"new"),text:e.returning?Ht.returning:Ht.new}:{type:r||"noCallout"}}(e);return e.quantity.account_remaining&&"locked"!==t.type?{type:t.type||"noCallout",text:t.text,template:null,endTime:null,details:Nt(Ht.accountleft,{amount:e.quantity.account_remaining})}:t}const jt={},Ut={};var zt=function(e,t){"number"==typeof e&&Array.isArray(t)&&t.length&&(jt[e]=t)},Wt=function(t){const n=jt[t];"number"==typeof t&&!(t in Ut)&&Array.isArray(n)&&n.length&&(n.forEach((function(t){e.call("SetTextEncryptionKey",parseInt(t.id,10),t.password)})),Ut[t]=!0)};const Yt=GW2?.galleryBase,Qt=GW2?.config?.features?.gallery;function Vt(e){Qt&&Yt&&e.galleryHashes&&(e.gallery=Object.entries(e.galleryHashes).map((([e,t])=>{const n=`${Yt}/${e||"44e4c6dd"}`;return{type:t,lightbox:`${n}_Lightbox.${"Video"===t?"webm":"png"}`,preview:`${n}_Preview.png`,thumbnail:`${n}_Thumbnail.png`}})))}function Kt(e,t,n){return M(t,e)&&M(e,n)}function Xt(t){const n=new Date(H()),i=e.stats,a=t.gem_store_item_id,r=s.merge({},window.gemstoreCatalog[a],t),o=`${(c=r.type||"").charAt(0).toUpperCase()}${c.slice(1)}`;var c;let l,u;return r[`is${o}`]=!0,r.guid=a,r.dataId=!!r.dataId&&parseInt(r.dataId,10),r.categories=B(r.categories||[],r.categoryLifespans,{ignoreOrder:!0}),r.quantities=r.listings,r.tags=r.tags.reduce(((e,t)=>(e[t.tag.toLowerCase()]=t,e)),{}),r.images=te(r),Vt(r),r.passwords&&(zt(r.dataId,Object.keys(r.passwords).map((e=>({id:e,password:r.passwords[e]})))),Wt(r.dataId)),(s.get(i.unlocks,[r.dataId,"permanent"])||localStorage[`unlock:${r.dataId}`])&&(r.quantities=[]),r.isUpgrade&&!function(t){const n=e.stats;return(GW2.config.featureIds&&GW2.config.featureIds[t.sku]||[]).every((e=>{const t=n.features[e];return t&&t.current<t.maximum}))}(r)&&(r.quantities=[]),Array.isArray(r.requiredFeatures)&&(r.missingFeatures=r.requiredFeatures.filter((e=>!i.features[e].current)),r.missingFeatures.length>0&&r.missingFeatures.length===r.requiredFeatures.length?r.requirementMissing?r.disabled=!0:r.hide=!0:r.missingFeatures=!1),Array.isArray(r.excludedFeatures)&&r.excludedFeatures.some((e=>i.features[e].current>0))&&(r.hide=!0),r.quantities=(t=>{const n=e.stats.vip&&e.stats.vip.active;return t.quantities.map((e=>{if(e.count=e.quantity,e.discount_type=e.discount,e.count=parseInt(e.count,10),Ue.forEach((t=>e[t]=t in e&&null!==e[t]?parseInt(e[t],10):null)),e.start=e.start&&new Date(e.start),e.end=e.end&&new Date(e.end),n?(e.regular_price=e.base_price,e.price=ze(e.vip_discount_price)?e.vip_discount_price:e.vip_base_price):e.price=ze(e.discount_price)?e.discount_price:e.base_price,e.discount_type&&(e.regular_price=n?e.vip_base_price:e.base_price,0===e.regular_price?e.percent_off=100:e.price===e.regular_price?e.percent_off=0:e.percent_off=(100*(1-e.price/e.regular_price)).toFixed()),"100"===e.percent_off&&(t.hasFree=!0),delete e.listings,e.deliverables){const t={};e.deliverables.forEach((e=>t[e.gem_store_item_id]=parseInt(e.quantity,10))),e.deliverables=t}return e})).filter((e=>null!==e)).sort(((e,t)=>(e.regular_price||e.price+1e6)-(t.regular_price||t.price+1e6)))})(r),r.soldOut=0===r.quantities.length,r.quantity=r.quantities[0]||{},r.start=r.quantity.start||!1,r.end=r.quantity.end||!1,r.randomchance&&GW2.config.countryRngExcludes.indexOf(GW2.config.country)>-1&&!function(e){return!!e.hasFree&&(e.quantities=e.quantities.filter((e=>"100"===e.percent_off)),!0)}(r)&&(r.requirementMissing=window.gemstore_strings.items.item.countryDisabled,r.disabled=!0,r.missingFeatures=!0,r.quantities=[],r.giftable=!1),r.isPackage&&(r.contents||(r.contents=[]),r.contents.forEach((e=>{window.gemstoreCatalog[e.guid]?.guid||(window.gemstoreCatalog[e.guid].guid=e.guid),ke.packageItemToPackages.has(e.guid)||ke.packageItemToPackages.set(e.guid,[]),ke.packageItemToPackages.get(e.guid).push(r.guid)})),l=r.quantity.deliverables||{},u={},r.excluded=r.contents.filter((e=>(!r.soldOut&&ke.inPackage.indexOf(e.guid)<0&&ke.inPackage.push(e.guid),e.disablePreview&&(u[e.guid]=!0),!(e.guid in l)))),r.included=Object.keys(l).map((e=>({guid:e,quantity:l[e],disablePreview:u[e]}))),0===r.included.length&&(r.soldOut=!0)),r.expireTime=function(e,t){if(e&&Kt(t,je(e,-1),e))return e}(r.end,n),r.expiring=r.end&&Kt(n,je(new Date(r.end),-7),new Date(r.end)),r.new=r.start&&Kt(n,new Date(r.start),je(new Date(r.start),14)),r.returning=r.new&&r.returning,r.callout=Bt(r),r.quantity.percent_off&&r.categories.push(j.sale.id),["new","expiring"].forEach((e=>r[e]&&r.categories.push(j[e].id))),"Exchange"===GW2.config.banners[r.guid]&&(r.isExchange=!0,r.categories.push(j.exchange.id)),r}async function Jt(e){e&&(e.delta?Object.keys(ke.catalog).length||(ke.catalog=De("gsCatalog:{lang}").items):(Object.keys(ke.catalog).forEach((t=>{e.items[t]||delete ke.catalog[t]})),ke.inPackage=[]),Object.keys(e.items).forEach((t=>{ke.catalog[t]=Xt(e.items[t])})),Z(),de(),GW2.config.features.upgrade&&function(e){if(!e?.items)return ke.upsell.name=null,void(ke.upsell.guid=null);const t=Object.keys(qe).filter((e=>!u().expansions[e])).filter((e=>{const t=qe[e]?.prerequisite;return!t||u().expansions[t]})).filter((t=>e.items[qe[t].guid])).filter((e=>{const t=qe[e];return!(t.featureKey&&!GW2.config.features[t.featureKey])})).sort(((t,n)=>{const i=qe[t],a=qe[n],r=Fe(e.items[i.guid]),s=Fe(e.items[a.guid]);return i.featured?-1:a.featured?1:r&&!s?-1:!r&&s?1:i.order-a.order}));if(0===t.length)return ke.upsell.name=null,void(ke.upsell.guid=null);const n=t[0],i=qe[n],a=Fe(e.items[i.guid]);ke.upsell.name=n,ke.upsell.guid=a&&i.discount_guid&&me(i.discount_guid)?i.discount_guid:i.guid}(e),ke.showingCached&&r.redraw())}class Zt{constructor(){this.keyToValue=new Map,this.valueToKeys=new Map}set(e,t){if(this.keyToValue.get(e)!==t){if(this.keyToValue.has(e)){const t=this.keyToValue.get(e);this._removeKeyFromValue(t,e)}this.keyToValue.set(e,t),this.valueToKeys.has(t)||this.valueToKeys.set(t,new Set),this.valueToKeys.get(t).add(e)}}get(e){return this.keyToValue.get(e)}getKeys(e){return this.valueToKeys.has(e)?Array.from(this.valueToKeys.get(e)):[]}has(e){return this.keyToValue.has(e)}hasValue(e){return this.valueToKeys.has(e)}keys(){return this.keyToValue.keys()}values(){return this.valueToKeys.keys()}entries(){return this.keyToValue.entries()}delete(e){if(this.keyToValue.has(e)){const t=this.keyToValue.get(e);this.keyToValue.delete(e),this._removeKeyFromValue(t,e)}}deleteByValue(e){if(this.valueToKeys.has(e)){const t=this.valueToKeys.get(e);for(const e of t)this.keyToValue.delete(e);this.valueToKeys.delete(e)}}clear(){this.keyToValue.clear(),this.valueToKeys.clear()}size(){return this.keyToValue.size}_removeKeyFromValue(e,t){if(this.valueToKeys.has(e)){const n=this.valueToKeys.get(e);n.delete(t),0===n.size&&this.valueToKeys.delete(e)}}}const en=GW2.config.catalogRefreshMs||5e3,tn=GW2?.config?.enablePartialPricing,{EItemType:nn,EContentType:{valueToNativeQuery:an}={}}=GW2?.config?.enums||{},rn=new Zt,sn=new Map;function on(){e.isMockEnv||(Object.entries(window.gemstoreCatalog).forEach((([e,t])=>{if(rn.has(e))return;const n=ke.catalog[e]||t;if(n?.isPackage||"package"===n.type){const t=n.included?.map((e=>e.guid)).filter((e=>{const t=me(e);return t&&"number"==typeof t.dataId&&!t.isContent}));return t?.forEach((e=>{rn.set(e,me(e).dataId)})),void sn.set(e,t)}n.dataId&&rn.set(e,n.dataId)})),function(){const e=new Map(Array.from(rn.entries()).filter((([e])=>{if(ke.guidToPreviewType.has(e))return!1;const t=me(e);return!t.dataId||t.isContent||t.soldOut&&ke.inPackage.indexOf(e)<0?(ke.guidToPreviewType.set(e,ge.NONE),!1):!t.gallery||(ke.guidToPreviewType.set(e,ge.GALLERY),!1)})));e.size&&m("gw2/ui/paperdoll").then((t=>{const n=new Map;t.canPreviewBatch(Array.from(e.values())).then((i=>{let a=0;for(const[t,r]of e)i[a]?(ke.guidToPreviewType.set(t,ge.PAPERDOLL),n.set(t,r)):ke.guidToPreviewType.set(t,ge.NONE),a++;return t.canNativePreviewBatch(Array.from(n.values()))})).then((e=>{let t=0;for(const i of n.keys())e[t]&&ke.guidToPreviewType.set(i,ge.NATIVE),t++;for(const[e,t]of sn)"number"==typeof me(e)?.dataId&&t.some((e=>ke.isPreviewable(e)))&&ke.guidToPreviewType.set(e,ge.PAPERDOLL);ke.firstLoadPreviewGuid&&(ke.highlightItem(me(ke.firstLoadPreviewGuid)),ke.firstLoadPreviewGuid=null)}))}))}(),function(){if(!tn)return;if(!Object.entries(an)?.length)return;const t=new Map(Array.from(rn.entries()).filter((([e])=>!ke.guidToIsUnlocked.has(e))).filter((([e])=>{const t=me(e);return!(!t.dataId||t.isContent||t.soldOut&&ke.inPackage.indexOf(e)<0)||(ke.guidToIsUnlocked.set(e,!1),!1)})));if(!t.size)return;const n=new Map;e.call("QueryItemInfo",{items:Array.from(t.values()),checkUnlock:!0}).then((t=>{for(const[e,i]of Object.entries(t)){const t=Number(e),{unlockType:a,unlockDataId:r,itemType:s}=i;nn.CONTAINER&&nn.valueToKey?.[s]===nn.CONTAINER||(a&&r?(n.has(a)||n.set(a,new Zt),n.get(a).set(t,r)):rn.getKeys(t).forEach((e=>ke.guidToIsUnlocked.set(e,!1))))}const i=[];for(const[t,a]of n){const n=an?.[t];n?i.push(e.call(n,[{dataIds:Array.from(a.values())}]).then((e=>{for(const[t,n]of Object.entries(e)){const e=Number(t);a.getKeys(e).flatMap((e=>rn.getKeys(e))).forEach((e=>ke.guidToIsUnlocked.set(e,n)))}}))):console.error("Unknown unlockType: ",t)}Promise.allSettled(i).then((()=>{for(const[e,t]of sn)ke.guidToPartiallyUnlocked.set(e,t?.some((e=>ke.isUnlocked(e))))}))}))}())}function cn(){return Ne().then(Jt).then(on).then((()=>{r.redraw(),window.setTimeout(cn,en)})).catch((()=>window.setTimeout(cn,2*en)))}function ln(){var t;return t=GemStore.gsOverrideTime||Date.now(),N=new Date(t).getTime(),GemStore.gsOverrideTime&&(ke.timePicker=!0),e.call("SetLoading",!0),function(){const e=De("gsCatalog:{lang}");return e?(ke.showingCached=!0,ke.group=e.test_group_guid,Promise.resolve(e)):Promise.reject("No cached data available")}().catch(Ne).then(Jt).then((()=>{s.each(window.gemstoreCatalog,((e,t)=>{ke.catalog[t]||(e.images=te(e),Vt(e),e.quantities=[],e.quantity={},e.isItem="item"===e.type,e.callout={})}))})).then(on).then((()=>{ke.showingCached?cn():setTimeout(cn,en),window.setInterval(r.redraw,1e3),ke.resultsChanged=!0,e.call("SetLoading",!1)}))}function un(){return Te({protocol:"Game.gw2.GemStore",command:"GetHistory",body:{Count:30}}).then((function(e){if(!e.purchases.length)return[];const t=e.purchases.map((e=>((e=s.merge(e,e.guid in ke.catalog?ke.catalog[e.guid]:window.gemstoreCatalog[e.guid],{purchased:{count:parseInt(e.quantity,10),price:parseInt(e.total_price,10)},images:te(window.gemstoreCatalog[e.guid]),active:e.guid in ke.catalog})).quantities&&e.quantities.some((t=>t.count===e.purchased.count&&t.price===e.purchased.price&&(e.purchased=t))),e))).filter((e=>!e.hide));return ke.purchases=t,"history"===ke.flyout&&r.redraw(),t}))}var dn={exports:{}};!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=a(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var i="";for(var r in e)t.call(e,r)&&e[r]&&(i=a(i,r));return i}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(dn);var mn=n(dn.exports);var gn="mcad2ab051_gems",fn="mcad2ab051_gemsCount",pn="mcad2ab051_gemPartialPricing";const hn={view:({attrs:t})=>{const{amount:n,cssClass:i,isPartiallyUnlocked:a}=t,s=parseInt(n,10),o=String(s).length;return r("span",{class:mn(gn,i,a&&pn),total:s,"data-digits":o},r("span",{class:fn},o>3?s.toLocaleString(e.stats.language):s))}};function vn(){e.import("gw2/ui/dialog").then((e=>{e.toggleNative("EconRestrict")}))}const bn={complete:function(e,t){t._gw2EmbedComplete()},launchbrowser:function(t){e.call("ShowInDefaultBrowser",t.data.url||"")},getsession:function(t){Te({protocol:"Auth",command:"GetUserInfo"}).then((n=>{t.source.postMessage({command:"getsession",data:{id:e.stats.sessionId,userId:n.user_id,email:n.login_name}},t.origin)}))},features:function(t){t.source.postMessage({command:"features",data:e.stats.features},t.origin)},getorigin:function(e,t){t.embedSource=e.source,t.embedOrigin=e.origin,e.source.postMessage({command:"getorigin",data:{origin:window.location.origin}},e.origin)},imeclient:function(e){const t=e.data,n=t&&t.state,i=t&&t.width,a=t&&t.height;n.left=n.left+(950-i)/2,n.top=n.top+(700-a)/2,GW2.Ime=n}};var yn={handleMessage:function(e,t){const n="string"==typeof t.data.command&&t.data.command.toLowerCase(),i=bn[n];!function(e,t){const n=e.source,i=e.data;if(n===window&&i&&i.length&&"ime:native"===i[0])return t.embedSource.postMessage(i,"*"),!0}(t,e)&&"function"==typeof i&&function(e){const t=new URL(e).hostname;return GW2.config.embedOrigins.some((function(e){return i=e,-1!==(n=t).indexOf(i,n.length-i.length);var n,i}))}(t.origin)&&i(t,e)}};const _n=r.buildQueryString||r.route.buildQueryString;const wn=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`.toUpperCase()}(),xn=r.buildQueryString||r.route.buildQueryString;function kn(t){return function(t){const n=s.merge({s:e.stats.sessionId,gems:e.stats.gems,shoppingSession:wn},t);return s.each(n,((e,t)=>{null==e&&delete n[t]})),r.request({url:`/log?${xn(n)}`})}(s.merge({action:"navigation",packageDetails:ke.search.package,clickedItem:ke.clickedItem,searchTerm:ke.search.text,categories:(ke.search.category||[]).join(","),group:ke.group},t))}var In="mca4ecd4a7_container",Tn="mca4ecd4a7_orderId",Cn="mca4ecd4a7_errorCode",Pn="mca4ecd4a7_innerContent",Sn={view(e){const{error:t={},orderId:n}=e.attrs||e,i=window.gemstore_strings.buyGems.error;let a=i;return"steam"===t.error?a=i.steam:"bep"===t.error&&(a=i.bep),r("div",{class:In},r("div",{class:Pn},r("h1",a.header),r("p",a.intro),n?r("p",{class:Tn},i.orderId,n):null,t.errorCode?r("p",{class:Cn},i.code,t.errorCode):null))}};const $n="mc95ee6c1f_btn",En=$n+" mc95ee6c1f_blueBig",Dn=$n+" mc95ee6c1f_colored";var On={btn:$n,large:"mc95ee6c1f_btn mc95ee6c1f_large",blueBig:En,colored:Dn,blue:"mc95ee6c1f_btn mc95ee6c1f_colored mc95ee6c1f_blue",purple:"mc95ee6c1f_btn mc95ee6c1f_colored mc95ee6c1f_purple",yellow:"mc95ee6c1f_btn mc95ee6c1f_colored mc95ee6c1f_yellow",orange:"mc95ee6c1f_btn mc95ee6c1f_colored mc95ee6c1f_orange"};const An={noCallout:"F5B24A",sale:"F5B24A",endingTime:"F74500",endingLimit:"F74500",expiring:"71A3D8",new:"71A3D8",white:"FFFFFF"},Ln=m("gw2/ui/tooltip");function Gn(e){return e.map((e=>`<c=#71A3D8>[${e.count>1?`${e.count}/`:""}${e.price} ${GemStore.i18n.tooltip.gems}]</c>`)).join("  ")}function qn(e){return(e||[]).map((e=>e.addendum)).filter(Boolean).join("\n")||""}function Rn(e){return e.text?`<c=#${An[e.type]}>${e.text}</c>\n`:""}function Mn(e){const t=e.gem_store_description||e.description||"";return t?`${t}`:""}function Fn(e){const t=e.details||e.getDetails&&e.getDetails();return t?`\n<c=#${An[e.type]}>${t}</c>`:""}function Nn(e,t){const n=e.quantity>1?`(${e.quantity}) `:"";return`<c=#${An[t]}>\u2022 ${n}${me(e.guid).name}</c>`}function Hn(e,t){t.redraw=!1,Ln.then((n=>{if(!e||"mouseout"===t.type)return n.hide();if(e.isPackage)return n.showText(function(e){const t=[];let n=e.included,i=e.excluded;return t.push(`<c=#FFE51F>${e.name}</c>`),t.push(Rn(e.callout)+Gn(e.quantities)+Fn(e.callout)),t.push(Mn(e)),n=n.map((e=>Nn(e,"white"))),n.length&&t.push(`${GemStore.i18n.items.item.package.contains}\n${n.join("\n")}`),i=i.map((e=>Nn(e,"noCallout"))),i.length&&t.push(`<c=#F5B24A>${GemStore.i18n.items.item.package.warning}</c>\n${i.join("\n")}`),t.push(qn(e.categories)),t.filter(Boolean).join("\n\n")}(e));if(!e.isItem)return n.showText(e.description||"");Wt(e.dataId);const i=[Rn(e.callout)+Gn(e.quantities)+Fn(e.callout),Mn(e),qn(e.categories)].filter(Boolean).join("\n\n");return n.showItem(e.itemGuid,{textNameOverride:e.name,textDescHeaderOverride:"",textDescOverride:`\n${i}\n`})}))}const Bn="mc3b5ae5ae_bd",jn="mc3b5ae5ae_ft";var Un={container:"mc3b5ae5ae_container",hd:"mc3b5ae5ae_hd",title:"mc3b5ae5ae_title",bd:Bn,key:"mc3b5ae5ae_key",invalid:"mc3b5ae5ae_invalid",ft:jn,overlay:"mc3b5ae5ae_overlay",overlayText:"mc3b5ae5ae_overlayText",successBd:"mc3b5ae5ae_bd mc3b5ae5ae_successBd",successTitle:"mc3b5ae5ae_successTitle",items:"mc3b5ae5ae_items",item:"mc3b5ae5ae_item",successFt:"mc3b5ae5ae_ft mc3b5ae5ae_successFt",details:"mc3b5ae5ae_details",name:"mc3b5ae5ae_name",icon:"mc3b5ae5ae_icon"};const zn=window.gemstore_strings.codes;function Wn(e){return e.replace(/[^A-Z0-9]/gi,"")}var Yn={oninit(){const t=this;this.successItems=[],this.gameAccount=null,this.redeem=function(){const n=Wn(t.code);return Promise.all([Te({protocol:"Auth",command:"ListMyGameAccounts",body:{GameCode:e.buildInfo.gameCode}}).then((e=>e[0])),Te({protocol:"Game.gw2.GemStore",command:"GetKeyInfo",body:{ProductKey:n}}).then((e=>({all:e.items.concat(e.features||[]),items:e.items})))]).then((t=>{const i=t[0],a=t[1].all;if(!a.length)throw new Error("No items from code");return Te({protocol:"Auth",command:"AddProductKey",body:{GameCode:e.buildInfo.gameCode,ProductKey:n,Alias:i.alias,Language:e.stats.language||"en"}}).then((()=>a))})).then((t=>e.call("QueryItemInfo",{items:t.map((e=>parseInt(e.data_id,10)))}).then((e=>t.map((t=>s.merge(t,e[t.data_id]))))))).then((e=>t.successItems=e)).catch((e=>{t.error=zn.step.code.error,"ErrCdKeyInUse"===e.reason&&(t.error=zn.step.code.already.used)}))},this.code="",this.error=null},view(e){const t=25===Wn(e.state.code).length;return e.state.successItems.length>0?r("div",{class:Un.container},r("div",{class:Un.hd},r("h4",{class:Un.title},zn.step.success.title),zn.step.success.item.text),r("div",{class:Un.successBd},r("h4",{class:Un.successTitle},zn.step.success.header),r("ul",{class:Un.items},e.state.successItems.map((e=>r("li",{class:Un.item},r("div",{class:Un.icon,"data-count":e.count>1?e.count:"",onmouseenter:t=>Hn(e,t),onmouseleave:e=>Hn(null,e)},r("img",{src:`coui://item/${e.data_id}`})),r("div",{class:Un.details},r("div",{class:mn(Un.name,e.rarityWord.toLowerCase())},e.name))))))),r("div",{class:Un.successFt},r("button",{class:On.btn,onclick:function(){e.state.successItems=[]}},zn.button.anothercode),r("button",{class:On.btn,onclick:ke.hidePopup},window.gemstore_strings.flow.button.done))):r("div",{class:Un.container},r("div",{class:Un.hd},r("h4",{class:Un.title},zn.redeemitem.link),zn.step.code.intro),r("div",{class:Un.bd},r("input",{class:mn(Un.key,!t&&Un.invalid),placeholder:zn.placeholder.code,maxlength:29,oninput:t=>{e.state.code=t.currentTarget.value}}),r("button",{class:On.large,onclick:e.state.redeem},zn.button.redeem)),e.state.error?r("div",{class:Un.ft},r.trust(e.state.error)):null)}};const Qn="mc2f4756c4_serif";var Vn=Qn;const Kn=Qn+" mc5e968da7_buyGems";var Xn={$values:{gw2Css:'"../../commerce/gw2.d54f081c.css"',iconSize:"44px",easein:"0.3s ease-in"},nav:"mc5e968da7_nav",vip:"vip",balance:"mc5e968da7_balance",top:"mc5e968da7_top",gems:"mc2f4756c4_serif mc5e968da7_gems",buyGems:Kn,buyHover:"mc5e968da7_buyHover",buyDisabled:"mc2f4756c4_serif mc5e968da7_buyGems mc5e968da7_buyDisabled",redeemCode:"mc5e968da7_redeemCode",redeemDisabled:"mc5e968da7_redeemCode mc5e968da7_redeemDisabled",sections:"mc5e968da7_sections",section:"mc5e968da7_section",hover:"mc5e968da7_hover",active:"mc5e968da7_active",icon:"mc5e968da7_icon",text:"mc5e968da7_text"};var Jn={$values:{size:"150px"},gfnContainer:"mc291d329d_gfnContainer",gfnInfo:"mc291d329d_gfnInfo",gfnQr:"mc291d329d_gfnQr",gfnSpacer:"mc291d329d_gfnSpacer",gfnEmail:"mc291d329d_gfnEmail",gfnEmailBtn:"mc2f4756c4_serif mc5e968da7_buyGems mc291d329d_gfnEmailBtn",gfnEnvelope:"mc291d329d_gfnEnvelope",gfnGetEmail:"mc291d329d_gfnGetEmail"};const Zn=r.buildQueryString||r.route.buildQueryString,ei={oninit(){e.call("SetLoading",!1)},view(t){const n=window.gemstore_strings,{embedInfo:i,showPopup:a}=t.attrs;return r("div",{class:Jn.gfnContainer},r("h1",n.gfn[i.type].title),r("h2",r.trust(n.gfn[i.type].subtitle)),r("div",{class:Jn.gfnInfo},r("img",{src:i.qr,class:Jn.gfnQr}),r("div",{class:Jn.gfnSpacer},r("hr"),r("p",n.gfn.or),r("hr")),r("div",{class:Jn.gfnEmail},i.emailed||t.state.clicked?[r("img",{class:Jn.gfnEnvelope,src:"https://2gemstore.staticwars.com/img/mail_icon.3db89737.svg"}),r("p",{class:Jn.gfnGetEmail},n.gfn.checkEmail)]:r("button",{class:Jn.gfnEmailBtn,onclick(){t.state.clicked=!0,r.request({url:`/ws/email/${i.type}?${Zn({s:e.stats.sessionId,lang:e.stats.language.slice(0,2)})}`}).then((e=>{a&&a((()=>r(ei,{embedInfo:e})))}))}},n.gfn[i.type].email))),r("p",n.gfn.unavailable),r("p",r.trust(n.gfn.moreInfo)))}};var ti="mc5f97db4f_overlay",ni="mc5f97db4f_fadeIn",ii="mc5f97db4f_popup",ai="mc5f97db4f_popup mc5f97db4f_large",ri="mc5f97db4f_content",si="mc5f97db4f_external",oi="mc5f97db4f_close";const ci=window.gemstore_strings,li={view(e){const{frame:t}=e.attrs;return[r("div",{class:Un.overlay},r("div",{class:Un.overlayText},ci.codes.redeemitem.text),r("button",{class:On.btn,onclick:()=>ke.showPopup((()=>r(Yn)))},ci.codes.redeemitem.link)),t]}};function ui(t){var n;kn({action:`open:${t}`}),(n={type:t},e.call("SetLoading",!0),r.request({url:`/ws/embed/v2/${n.type}?${_n({s:e.stats.sessionId,lang:e.stats.language.slice(0,2),visible:n.visible,china:n.china,upgrades:n.upgrades,owned:n.owned,required:n.required,provider:n.provider,remoteClientIp:e.player.remoteClientIp})}`}).then((t=>{let n;return{complete:new Promise((e=>{n=e})),frame:r("iframe[seamless]",{src:t.url,style:{background:"transparent",width:`${t.width}px`,height:`${t.height}px`},onload(){e.call("SetLoading",!1)},config(e,t){t||(e._gw2EmbedComplete=n,window.onmessage=yn.handleMessage.bind(null,e))},oncreate(e){e.dom._gw2EmbedComplete=n,window.onmessage=yn.handleMessage.bind(null,e.dom)}}),embedInfo:t}}))).then((n=>{let i=null;"codes"===t&&"gw2cn"!==e.buildInfo.gameCode&&(n.frame=r(li,{frame:n.frame})),"gems"===t&&n.embedInfo.gfn&&(n.frame=r(ei,{embedInfo:n.embedInfo,showPopup:ke.showPopup})),"external"===t&&(i=si),ke.showPopup(n.frame,i),n.complete.then((()=>{ke.hidePopup(),r.redraw()}))})).catch((n=>{if("gems"===t||"external"===t)return e.call("SetLoading",!1),ke.showPopup(r(Sn));console.log("unhandled error")}))}function di(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,a,r=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s}var mi;!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(mi||(mi={}));var gi={type:"xstate.init"};function fi(e){return void 0===e?[]:[].concat(e)}function pi(e){return{type:"xstate.assign",assignment:e}}function hi(e,t){return"string"==typeof(e="string"==typeof e&&t&&t[e]?t[e]:e)?{type:e}:"function"==typeof e?{type:e.name,exec:e}:e}function vi(e){return function(t){return e===t}}function bi(e){return"string"==typeof e?{type:e}:e}function yi(e,t){return{value:e,context:t,actions:[],changed:!1,matches:vi(e)}}function _i(e,t,n){var i=t,a=!1;return[e.filter((function(e){if("xstate.assign"===e.type){a=!0;var t=Object.assign({},i);return"function"==typeof e.assignment?t=e.assignment(i,n):Object.keys(e.assignment).forEach((function(a){t[a]="function"==typeof e.assignment[a]?e.assignment[a](i,n):e.assignment[a]})),i=t,!1}return!0})),i,a]}var wi=function(e,t){return e.actions.forEach((function(n){var i=n.exec;return i&&i(e.context,t)}))};const xi="mcec0a7571_innerContent",ki="mcec0a7571_gems";var Ii={container:"mcec0a7571_container",orderId:"mcec0a7571_orderId",innerContent:xi,listing:"mcec0a7571_listing",gems:ki,"gems-400":"mcec0a7571_gems mcec0a7571_gems-400","gems-800":"mcec0a7571_gems mcec0a7571_gems-800","gems-1600":"mcec0a7571_gems mcec0a7571_gems-1600","gems-2800":"mcec0a7571_gems mcec0a7571_gems-2800","gems-4000":"mcec0a7571_gems mcec0a7571_gems-4000","gems-8000":"mcec0a7571_gems mcec0a7571_gems-8000",gemSpinner:"mcec0a7571_gemSpinner",spinner:"mcec0a7571_spinner",details:"mcec0a7571_details",detailGems:"mcad2ab051_gems mcad2ab051_gemsLight mcec0a7571_detailGems",item:"mcec0a7571_innerContent mcec0a7571_item",tax:"mcec0a7571_innerContent mcec0a7571_tax",total:"mcec0a7571_innerContent mcec0a7571_total",price:"mcec0a7571_price",buttons:"mcec0a7571_buttons",button:"mcec0a7571_button",disclaimer:"mcec0a7571_disclaimer"};var Ti="mce253745a_spinner",Ci={view:function(){return r("div",{class:Ti})}},Pi={view(e){const{steamId:t,orderId:n,transId:i,amount:a,totalPretty:s,items:o}=e.attrs,c=window.gemstore_strings.buyGems.success;return r("div",{class:Ii.container},r("div",{class:Ii.innerContent},r("h1",c.header),r("p",c.intro)),r("div",{class:Ii.details},r("div",r("h2",c.summary.header),r("div",{class:Ii.item},r("div",{class:Ii.detailGems},c.gemsAmount.replace("{amount}",a)),r("div",{class:Ii.price},o[0].pretty.amount)),r("div",{class:Ii.tax},r("div",c.summary.tax),r("div",{class:Ii.price},o[0].pretty.vat)),r("div",{class:Ii.total},r("div",c.summary.total),r("div",{class:Ii.price},s))),r("div",r("h2",c.payment.header),r("p",c.payment.steam.replace("{last4}",t.slice(t.length-4))),r("h2",c.transId),r("p",i),r("h2",c.orderId),r("p",n))),r("div",{class:Ii.buttons},r("button",{class:Ii.button,onclick(){ke.hidePopup()}},c.done)))}};const Si=r.buildQueryString||r.route.buildQueryString;function $i(){return function(e,t){void 0===t&&(t={});var n=di(_i(fi(e.states[e.initial].entry).map((function(e){return hi(e,t.actions)})),e.context,gi),2),i=n[0],a=n[1],r={config:e,_options:t,initialState:{value:e.initial,actions:i,context:a,matches:vi(e.initial)},transition:function(t,n){var i,a,s="string"==typeof t?{value:t,context:e.context}:t,o=s.value,c=s.context,l=bi(n),u=e.states[o];if(u.on){var d=fi(u.on[l.type]);"*"in u.on&&d.push.apply(d,function(e,t,n){if(n||2===arguments.length)for(var i,a=0,r=t.length;a<r;a++)!i&&a in t||(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||Array.prototype.slice.call(t))}([],di(fi(u.on["*"])),!1));try{for(var m=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(d),g=m.next();!g.done;g=m.next()){var f=g.value;if(void 0===f)return yi(o,c);var p="string"==typeof f?{target:f}:f,h=p.target,v=p.actions,b=void 0===v?[]:v,y=p.cond,_=void 0===y?function(){return!0}:y,w=void 0===h,x=null!=h?h:o,k=e.states[x];if(_(c,l)){var I=di(_i((w?fi(b):[].concat(u.exit,b,k.entry).filter((function(e){return e}))).map((function(e){return hi(e,r._options.actions)})),c,l),3),T=I[0],C=I[1],P=I[2],S=null!=h?h:o;return{value:S,context:C,actions:T,changed:h!==o||T.length>0||P,matches:vi(S)}}}}catch(e){i={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}}return yi(o,c)}};return r}({id:"buyGemsMachine",initial:"gettingPrices",context:{gems:[]},states:{gettingPrices:{entry:pi({params:()=>Si({s:e.stats.sessionId,lang:e.stats.language.slice(0,2),gameCode:e.buildInfo.gameCode,type:"gems"})}),on:{ONDONE:{target:"idle",actions:pi({gems:(e,{data:t})=>t})},ONERROR:{target:"error",actions:pi({error:(e,{error:t})=>t})}}},idle:{on:{NEXT:{target:"startingPurchase",actions:pi({selectedIdx:(e,{idx:t})=>t,loading:()=>!0,cancelled:()=>!1})}}},startingPurchase:{on:{ONDONE:{target:"waitingForSteam",actions:pi({orderId:(e,{data:t})=>t.orderId})},ONERROR:{target:"cancelling",actions:pi({error:(e,{error:t})=>t})}}},waitingForSteam:{on:{ONDONE:"finalizing",ONERROR:{target:"cancelling",actions:pi({cancelled:()=>!0})}}},finalizing:{on:{ONDONE:{target:"success",actions:(e,{data:t})=>(e.steamId=t.steamId,e.transId=t.transId,e.amount=t.amount,e.totalPretty=t.totalPretty,e.items=t.items,e.loading=!1,e)},ONERROR:{target:"cancelling",actions:pi({error:(e,{error:t})=>t})}}},success:{},cancelling:{on:{ONDONE:[{cond:e=>e.cancelled,target:"idle",actions:e=>(delete e.transId,delete e.amount,delete e.totalPretty,delete e.items,e.loading=!1,e)},{target:"error",actions:pi({loading:()=>!1})}],ONERROR:{target:"error",actions:pi({loading:()=>!1})}}},error:{}}})}const Ei={gettingPrices:function({context:e}){return r.request({url:`/ws/gems?${e.params}`})},startingPurchase:function({context:e}){return r.request({url:`/ws/steamPurchase?${e.params}`,method:"POST",data:e.gems[e.selectedIdx]})},waitingForSteam:function({context:t}){return new Promise(((n,i)=>{e.call("SteamPurchase",t.orderId).then((e=>{const{orderId:a,authorized:r}=e;if(!r||t.orderId!==a)return i("steamAuth");n()}),(e=>{i(e)}))}))},finalizing:function({context:e}){return r.request({url:`/ws/steamFinalize?${e.params}`,method:"POST",data:{orderId:e.orderId}})},cancelling:function({context:e}){return r.request({url:`/ws/steamCancel?${e.params}`,method:"POST",data:{orderId:e.orderId}})}};const Di=window.gemstore_strings.buyGems;let Oi,Ai,Li;const Gi={view(t){const{alias:n}=t.attrs;return r("a",{onclick(){e.call("ShowInDefaultBrowser",GW2.config.legalUrls[n])}},Di[n])}};var qi={oninit(){const e=$i();Oi=function(e){var t=e.initialState,n=mi.NotStarted,i=new Set,a={_machine:e,send:function(a){n===mi.Running&&(t=e.transition(t,a),wi(t,bi(a)),i.forEach((function(e){return e(t)})))},subscribe:function(e){return i.add(e),e(t),{unsubscribe:function(){return i.delete(e)}}},start:function(i){if(i){var r="object"==typeof i?i:{context:e.config.context,value:i};t={value:r.value,actions:[],context:r.context,matches:vi(r.value)}}else t=e.initialState;return n=mi.Running,wi(t,gi),a},stop:function(){return n=mi.Stopped,i.clear(),a},get state(){return t},get status(){return n}};return a}(e),Li=Oi.subscribe((e=>{Ai=e,function(e,t){const n=Ei[e.value];n&&n(e).then((e=>{t.send({type:"ONDONE",data:e})})).catch((e=>{t.send({type:"ONERROR",error:e})}))}(Ai,Oi)})),Oi.start()},onremove(){Li.unsubscribe(),Oi.stop()},view(){const{gems:t,loading:n}=Ai.context;return"success"===Ai.value?r(Pi,Ai.context):"error"===Ai.value?r(Sn,Ai.context):r("div",{class:Ii.container},r("div",{class:Ii.innerContent},r("h1",Di.list.header),Ai.context.cancelled?[r("p",Di.error.steamAuth),r("p",{class:Ii.orderId},Di.error.orderId,Ai.context.orderId)]:r("p",Di.list.intro),r("div",{class:Ii.listing},t.length?t.map((({amount:e,prettyPrice:t},n)=>r("button",{"data-gems":`gems-${e}`,class:Ii[`gems-${e}`],onclick(){Oi.send({type:"NEXT",idx:n})}},r("div",Di.list.gemsAmount.replace("{amount}",e)),t))):r("div",{class:Ii.spinner},r(Ci))),r("div",{class:Ii.footer},r("p",Di.list.paymentDesc)),"gw2cn"!==e.buildInfo.gameCode&&r("div",{class:Ii.disclaimer},r("p",Di.disclaimer),r("p",function(e,t){return e.split(/\{(.+?)\}/g).map((function(e){return t[e]||e}))}(Di.legalUrls,{userAgreement:r(Gi,{alias:"userAgreement"}),virtualGoods:r(Gi,{alias:"virtualGoods"})})))),n?r("div",{class:Ii.spinner},r(Ci)):null)}};function Ri(){ke.features.billing.enabled&&(ke.isSteamUser()?ke.showPopup((()=>r(qi))):ui("gems"))}const Mi=En+" mcbbb59549_button";var Fi={actions:"mcbbb59549_actions",button:Mi,buttonSale:"mc95ee6c1f_btn mc95ee6c1f_blueBig mcbbb59549_button mcbbb59549_buttonSale",qtyButton:"mc95ee6c1f_btn mc95ee6c1f_blueBig mcbbb59549_button mcbbb59549_qtyButton",priceContainer:"mcbbb59549_priceContainer",price:"mcbbb59549_price",regularPrice:"mcbbb59549_regularPrice",qty:"mcbbb59549_qty"};const Ni=window.gemstore_strings;function Hi(t,n,i){const a=n.bundle_price||n.regular_price,s=ke?.isPartiallyUnlocked(t.guid);return r(".action",r("button",{class:n.count>1?Fi.qtyButton:Fi[n.percent_off?"buttonSale":"button"],onclick:t.missingFeatures||!ke.features.purchasing.enabled?vn:function(a){a.stopPropagation(),ke.features.purchasing.enabled&&(n.price>e.stats.gems?Ri():(he(),e.call("HideTextTooltip"),ke.purchase.info={guid:t.guid,price:n.price,count:n.count},kn({action:"priceClick",source:"history"===i?"history":"item",purchaseGuid:ke.purchase.info.guid,purchaseCount:ke.purchase.info.count,gemPrice:ke.purchase.info.price}),ke.flyout&&ke.setFlyout(null)))},onmouseenter:s&&function(){e.call("ShowTextTooltip",Ni.tooltip.partialPricing)},onmouseleave:s&&function(){e.call("HideTextTooltip")}},r("div",{class:Fi.priceContainer},n.count>1?r("span",{class:Fi.qty},n.count):null,r(hn,{amount:n.price,cssClass:Fi.price,isPartiallyUnlocked:s}))),a&&"history"!==i&&r("div",{class:Fi.regularPrice},n.count>1&&`${n.count}/ `,a))}function Bi(e,t){return r("div",{class:Fi.actions},e.quantities.map((n=>Hi(e,n,t))))}const ji="mca661b516_icon";var Ui={container:"mca661b516_container",expandedContainer:"mca661b516_container mca661b516_expandedContainer",icon:ji};function zi(e,t){if(!e)return null;t||(t={});const n=s.merge({class:t.containerClass||(t.expand?Ui.expandedContainer:Ui.container)},t.attrs);return t.onclick&&(n.onclick=t.onclick),r("div",n,r("img",{class:t.class||Ui.icon,onupdate:function(e){e.dom.complete&&(e.dom.style.webkitTransition="none")},src:e.images?.[t.imageSize||"large"],onload:function(e){e.redraw=!1,this.style.opacity=1},onerror:function(n){"splash"!==t.imageSize?e.images.large=n.currentTarget.src=`${GW2.imageBase}/44e4c6dd_large.png`:e.images.splash=n.currentTarget.src=`${GW2.imageBase}/44e4c6dd_splash.jpg`}}))}var Wi={priceOnly:"mcbf3b1e1c_priceOnly",name:"mcbf3b1e1c_name",date:"mcbf3b1e1c_date",price:"mcbf3b1e1c_price",icon:"mca661b516_icon mcbf3b1e1c_icon",item:"mcbf3b1e1c_item",clickable:"mcbf3b1e1c_item mcbf3b1e1c_clickable",details:"mcbf3b1e1c_details"};function Yi(t){const n=!t.soldOut&&t.active,i=n&&t.quantities.some((e=>e.count===t.purchased.count&&e.price===t.purchased.price));return r("li",{class:n?Wi.clickable:Wi.item,onclick:()=>{t.categories.find((e=>J(e)))&&n&&(ke.setFlyout(null),ke.highlightItem(t,null,{src:"history"}))}},zi(t,{class:Wi.icon}),r("div",{class:Wi.details},r("div",{class:Wi.name},t.name),r("div",{class:Wi.date},new Date(t.created).toLocaleDateString(e.stats.language))),r("div",{class:Wi.price},i?Hi(t,t.purchased,"history"):r("div",{class:Wi.priceOnly},t.purchased.count>1&&r.trust(`${t.purchased.count} /&nbsp;`),r(hn,{amount:t.purchased.price}))))}var Qi={headings:"mc2ca44b2c_headings",items:"mc2ca44b2c_items",item:"mc2ca44b2c_item",details:"mc2ca44b2c_details",noHistory:"mc2ca44b2c_noHistory",name:"mc2ca44b2c_name",date:"mc2ca44b2c_date",price:"mc2ca44b2c_price"};const Vi=window.gemstore_strings;var Ki={view:()=>[r("div",{class:Qi.headings},["name","date","price"].map((e=>r("div",{class:Qi[e]},Vi.history[e])))),r("ul",{class:Qi.items},ke.purchases.length>0?ke.purchases.map(Yi):r("h4",{class:Qi.noHistory},Vi.nav.noHistory))]};const Xi="mc3d30b8cb_control";var Ji={preview:"mc3d30b8cb_preview",controls:"mc3d30b8cb_controls",control:Xi,close:"mc3d30b8cb_control mc3d30b8cb_close",clear:"mc3d30b8cb_control mc3d30b8cb_clear"};const Zi={yellow:"#F5B24A",red:"#F74500",blue:"#71A3D8"},ea="mc5d1c3133_sideButton",ta="mc5d1c3133_callout";var na={$values:{callout:Zi,iconCss:'"../icon/icon.css"'},icon:"mca661b516_icon mc5d1c3133_icon",carousel:"mc5d1c3133_carousel",sideButton:ea,prevPage:"mc5d1c3133_sideButton mc5d1c3133_prevPage",prev:"mc5d1c3133_prev",nextPage:"mc5d1c3133_sideButton mc5d1c3133_nextPage",next:"mc5d1c3133_next",pager:"mc5d1c3133_pager",indicator:"mc5d1c3133_indicator",activePage:"mc5d1c3133_activePage",items:"mc5d1c3133_items",item:"mc5d1c3133_item",banner:"mc5d1c3133_banner",active:"mc5d1c3133_active",text:"mc5d1c3133_text",callout:ta,sale:"mc5d1c3133_callout mc5d1c3133_sale",new:"mc5d1c3133_callout mc5d1c3133_new",expiring:"mc5d1c3133_callout mc5d1c3133_expiring",returning:"mc5d1c3133_callout mc5d1c3133_returning",mustHave:"mc5d1c3133_callout mc5d1c3133_mustHave",endingTime:"mc5d1c3133_callout mc5d1c3133_endingTime",endingLimit:"mc5d1c3133_callout mc5d1c3133_endingLimit",name:"mc5d1c3133_name",left:"mc5d1c3133_left",right:"mc5d1c3133_right",middle:"mc5d1c3133_middle",skipAnimation:"mc5d1c3133_skipAnimation"};const ia=ea+" mc3141e88a_navArrow";var aa={$values:{carousel:'"../carousel/carousel.css"',uiScale:"1.1",uiDuration:"0.2s",uiColor:"#111B",uiOpacity:"0.8"},gallery:"mc3141e88a_gallery",previewContainer:"mc3141e88a_previewContainer",preview:"mc3141e88a_preview",navArrow:ia,leftArrow:"mc5d1c3133_sideButton mc3141e88a_navArrow mc3141e88a_leftArrow",rightArrow:"mc5d1c3133_sideButton mc3141e88a_navArrow mc3141e88a_rightArrow",thumbnailCarousel:"mc3141e88a_thumbnailCarousel",overflow:"mc3141e88a_overflow",thumbnail:"mc3141e88a_thumbnail",active:"mc3141e88a_active",lightbox:"mc3141e88a_lightbox",inactive:"mc3141e88a_inactive",lightboxGradient:"mc3141e88a_lightbox mc3141e88a_lightboxGradient",videoWrapper:"mc3141e88a_videoWrapper",hiddenOverlay:"mc3141e88a_hiddenOverlay",media:"mc3141e88a_media",videoOverlay:"mc3141e88a_videoOverlay",popupLightbox:"mc3141e88a_popupLightbox"};const ra={activeIndex:0,items:[],next:()=>{},prev:()=>{},inactivityTimeout:null,lastX:0,lastY:0,hideOverlay:!0,inactive:!1,oninit:function(e){ra.activeIndex=e.attrs.activeIndex,ra.items=e.attrs.items,ra.hideOverlay=!0,ra.prev=t=>{t.stopPropagation(),ra.activeIndex=e.attrs.prev(t),ra.hideOverlay=!0,clearTimeout(ra.inactivityTimeout)},ra.next=t=>{t.stopPropagation(),ra.activeIndex=e.attrs.next(t),ra.hideOverlay=!0,clearTimeout(ra.inactivityTimeout)}},view:function(){const{items:e,activeIndex:t,prev:n,next:i}=ra,a=e[t];return a?r("div",{class:mn(aa.lightboxGradient,ra.inactive?aa.inactive:""),onmousemove:function(e){const t=Math.abs(e.clientX-ra.lastX),n=Math.abs(e.clientY-ra.lastY);t<1&&n<1||(clearTimeout(ra.inactivityTimeout),ra.inactive=!1,ra.lastX=e.clientX,ra.lastY=e.clientY,ra.inactivityTimeout=setTimeout((()=>{ra.inactive=!0}),1e3))}},"Image"===a.type?r("img",{class:aa.media,src:a.lightbox}):null,"Video"===a.type?r("div",{class:mn(aa.videoWrapper,aa.videoOverlay,ra.hideOverlay?aa.hiddenOverlay:"")},r("video",{class:aa.media,src:a.lightbox,autoplay:!0,muted:!0,loop:!0,onclick:e=>{ra.hideOverlay=e.target.paused,e.target.paused?e.target.play():e.target.pause()}})):null,r("button",{class:aa.leftArrow,onclick:n}),r("button",{class:aa.rightArrow,onclick:i})):null}},sa={activeIndex:0,items:[],scrollToActiveThumbnail:function(){const e=document.querySelectorAll(`.${aa.thumbnail}`)[sa.activeIndex];e&&e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},next:function(e){return e.stopPropagation(),sa.activeIndex=(sa.activeIndex+1)%sa.items.length,sa.scrollToActiveThumbnail(),sa.activeIndex},prev:function(e){return e.stopPropagation(),sa.activeIndex=(sa.activeIndex-1+sa.items.length)%sa.items.length,sa.scrollToActiveThumbnail(),sa.activeIndex},oninit:function(e){sa.activeIndex=0,sa.items=e.attrs.item?.gallery||[]},view:function({attrs:e}){const{items:t,activeIndex:n,next:i,prev:a,scrollToActiveThumbnail:s}=sa;return t.length?r("div",{class:aa.gallery},r("div",{class:mn(aa.previewContainer,"Video"===t[n].type?aa.videoOverlay:""),onclick:()=>ke.showPopup((()=>r(ra,{items:t,activeIndex:n,next:i,prev:a})),aa.popupLightbox)},r("img",{class:aa.preview,src:t[n].preview}),r("button",{class:aa.leftArrow,onclick:a}),r("button",{class:aa.rightArrow,onclick:i})),r("div",{class:mn(aa.thumbnailCarousel,t.length>4?aa.overflow:"")},t.map(((t,i)=>r("div",{key:e.item.itemGuid+i,class:mn(aa.thumbnail,i===n?aa.active:"","Video"===t.type?aa.videoOverlay:""),onclick:()=>{sa.activeIndex=i,s()}},r("img",{src:t.thumbnail})))))):null}};var oa={view:function(){return r("div",{class:Ji.preview,style:{left:ke.previewType?"470px":"970px"}},r("div",{class:Ji.controls},ke.previewType===ge.PAPERDOLL?r("div",{class:Ji.clear,onclick:ve},window.gemstore_strings.clearPreview):null,r("div",{class:Ji.close,onclick:()=>{const e=document.querySelector("[item-list]");let t;if(!e)return void ke.closePreview();const n=e.childNodes[0].clientHeight;t=e.scrollTop+n/1.5,t-=t%n;const i=t/n%2==1?n/2:0;e.scrollTop=t/2-Math.floor(t%153)-i,ke.closePreview()}})),ke.previewGalleryItem?[r(sa,{key:ke.previewGalleryItem.itemGuid,item:ke.previewGalleryItem})]:null)}};function ca(t,n){return i=>{t?e.call("ShowTextTooltip",t):e.call("HideTextTooltip"),"function"==typeof n?n(i):i.redraw=!1}}var la={view:e=>r("svg",e.attrs,r("use",{oncreate:t=>{window.requestAnimationFrame((()=>t.dom.setAttributeNS("http://www.w3.org/1999/xlink","href",`/gen/icons.84a8c15b.svg#icon-${e.attrs.name}`)))}}))};function ua(t,n){const i=e.buildInfo.id||0,a=Array.isArray(t)?t:[t],o=me(a[0].guid),c={Guid:o.guid,BuildId:i,UseVip:e.stats.vip&&e.stats.vip.active?1:0,Time:GemStore.gsOverrideTime},l=Boolean(a[0].recipient),u={totalDiscount:0,totalPrice:0,numItems:0,gift:l,message:l&&n.message},d=[];return c.UseVip&&(c.VipLevel=e.stats.vip&&e.stats.vip.level),u.message&&(c.GiftMessage=u.message),o.isPackage&&(GW2.config.featureIds&&GW2.config.featureIds[o.dataId]||[]).forEach((function(t){e.call("BuyFeature",parseInt(t,10))})),a.forEach((function(t){const n=l?{RecipientPortalId:t.recipient.id}:{};kn({action:l?"giftPurchase":"purchase",source:l?"gifting":"purchasePrompt",purchaseGuid:ke.purchase.info.guid,purchaseCount:ke.purchase.info.count,gemPrice:ke.purchase.info.price}),d.push(Te({type:"None",protocol:"Game.gw2.GemStore",command:"Purchase",body:s.merge(n,c,{Quantity:t.count,TotalPrice:t.price,Language:e.stats.language||"",Items:o.isPackage?o.included.map((e=>({Id:e.guid,Quantity:e.quantity}))):null,TestGroupGuid:ke.group})}).then((function(){const n=e.stats.unlocks[o.dataId];l||!n||n.permanent||(localStorage[`unlock:${o.dataId}`]=!0),t.success=!0,Ne().then(Jt).then((()=>{un(),r.redraw()})),u.totalDiscount+=t.discount,u.totalPrice+=t.price,u.numItems+=t.count}),(function(){t.failure=!0})))})),Promise.all(d).then((function(){const t=a.filter((function(e){return!e.failure}));if(t.length<=0)throw new Error("purchase failure");return e.call("GetStats").then((t=>{e.stats=t})),s.merge(u,{purchases:a})}))}var da={0:"blocked",1:"ignored",2:"none",3:"keep",4:"follower",5:"following",6:"friend",blocked:0,ignored:1,none:2,keep:3,follower:4,following:5,friend:6};const ma=m("gw2/player"),ga={FRIEND:"friend",PARTY:"party",GUILD:"guild"};const fa="mc8f8cb826_dropdown",pa="mc8f8cb826_ddItem",ha=fa+" mc70f86b23_filterList",va=pa+" mc70f86b23_ddItem",ba=fa+" mc70f86b23_quantityList";var ya={$values:{dropdownCss:'"../../dropdown.ea6bc35.css"'},searchInput:"mc70f86b23_searchInput",contactList:"mc70f86b23_contactList",contacts:"mc70f86b23_contacts",contact:"mc70f86b23_contact",selected:"mc70f86b23_contact mc70f86b23_selected",search:"mc70f86b23_search",filterIcon:"mc70f86b23_filterIcon",filters:"mc70f86b23_filters",filterList:ha,visibleFilterList:"mc8f8cb826_dropdown mc70f86b23_filterList mc70f86b23_visibleFilterList",ddItem:va,selectedFilter:"mc8f8cb826_ddItem mc70f86b23_ddItem mc70f86b23_selectedFilter",check:"mc70f86b23_check",name:"mc70f86b23_name",quantities:"mc70f86b23_quantities",quantityList:ba,quantityListShow:"mc8f8cb826_dropdown mc70f86b23_quantityList mc70f86b23_quantityListShow",quantityListInverse:"mc70f86b23_quantityListInverse",quantity:"mc8f8cb826_ddItem mc70f86b23_ddItem mc70f86b23_quantity",multipleQuantities:"mc70f86b23_multipleQuantities",noContacts:"mc70f86b23_noContacts",tooMany:"mc70f86b23_tooMany"};const _a=window.gemstore_strings.gifting,wa={ALL:"all",...ga};var xa={oninit:function(){const t=this;t.filterHovered=!1,t.hoveredQuantities=null,t.filter={text:"",type:wa.ALL},t.quantitiesHover=function(e,n){t.inverseMenu=n.screenY>455,t.hoveredQuantities=e},t.addToOrder=function(e,t,n){ke.gifting.failure=!1,null!==n?ke.gifting.order[t.id]={guid:e,recipient:t,count:n.count,price:n.price,discount:(n.regular_price||n.price)-n.price}:delete ke.gifting.order[t.id]},t.filterContacts=function(){t.filteredContacts=ke.gifting.contacts.filter((function(e){return!!ke.gifting.order[e.id]||!(t.filter.type!==wa.ALL&&!e.types.includes(t.filter.type))&&!(t.filter.text&&!e.name.toLowerCase().includes(t.filter.text))})).slice(0,750)},t.filteredContacts=[],(ke.gifting.contacts=[],Promise.all([e.call("AccountGetContacts"),e.call("CharacterGetParty"),e.call("AccountGetGuilds"),ma]).then((function([e=[],t={},n=[],i]){const a=new Map;function r(e,t){if(e.id===i.portalUserId)return;const n=a.get(e.id);if(n)n.types.includes(t)||n.types.push(t);else{const n={id:e.id,name:e.name.replace(/^:/,""),types:[t]};a.set(e.id,n)}}e.forEach((e=>{e.relation!==da.following&&e.relation!==da.friend||r(e,ga.FRIEND)})),(t.members||[]).forEach((e=>r(e,ga.PARTY))),n.flatMap((e=>e.members||[])).forEach((e=>r(e,ga.GUILD))),ke.gifting.contacts=Array.from(a.values()).sort(((e,t)=>e.name.localeCompare(t.name)))}))).then((function(){t.filterContacts()}))},view:function(e){return r("div",{class:ya.contacts},r("div",{class:ya.search},r("input[type=search][required]",{class:ya.searchInput,placeholder:_a.step.gifts.contacts.searchplaceholder,oninput:t=>{e.state.filter.text=t.currentTarget.value.toLowerCase(),e.state.filterContacts()}}),r("div",{class:ya.filters,onmouseenter:()=>{e.state.filterHovered=!0},onmouseleave:()=>{e.state.filterHovered=!1}},r("div",{class:ya.filterIcon}),r("ul",{class:e.state.filterHovered?ya.visibleFilterList:ya.filterList},Object.values(wa).map((t=>r("li",{class:t===e.state.filter.type?ya.selectedFilter:ya.ddItem,onclick:function(){e.state.filter.type=t,e.state.filterHovered=!1,e.state.filterContacts()}},_a.step.gifts.contacts.filters[t])))))),r("ul",{class:ya.contactList},e.state.filteredContacts.map((t=>{const n=ke.gifting.order[t.id];let i=e.attrs.quantities[0];return n&&e.attrs.quantities.some((e=>e.count===n.count&&(i=e,!0))),r("li",{class:n?ya.selected:ya.contact,onclick:()=>e.state.addToOrder(e.attrs.guid,t,ke.gifting.order[t.id]?null:i)},r("div",{class:ya.name},t.name),r("div",{class:ya.quantities,onmouseenter:n=>e.state.quantitiesHover(t.id,n),onmouseleave:t=>e.state.quantitiesHover(null,t)},r("div",{class:mn(e.attrs.quantities.length>1&&ya.multipleQuantities)},i.count,_a.quantityforprice,r(hn,{amount:i.price})),e.state.hoveredQuantities&&e.attrs.quantities.length>1?r("ul",{class:mn(e.state.hoveredQuantities===t.id?ya.quantityListShow:ya.quantityList,e.state.inverseMenu&&ya.quantityListInverse)},e.attrs.quantities.map((n=>r("li",{class:ya.quantity,onclick:i=>{e.state.addToOrder(e.attrs.guid,t,n),e.state.hoveredQuantities=null,i.stopPropagation()}},n.count,_a.quantityforprice,r(hn,{amount:n.price}))))):""))})),750===e.state.filteredContacts.length&&r("li",{class:ya.tooMany},_a.step.gifts.contacts.more),0===e.state.filteredContacts.length&&r("li",{class:ya.noContacts},_a.step.gifts.contacts.noresults)))}};const ka="mc403c97cf_hd",Ia="mc403c97cf_bd";var Ta={gifting:"mc403c97cf_gifting",hd:ka,title:"mc403c97cf_title",bd:Ia,numRecipients:"mc403c97cf_numRecipients",summary:"mc403c97cf_summary",item:"mc403c97cf_item",icon:"mca661b516_icon mc403c97cf_icon",message:"mc403c97cf_message",orderSummary:"mc403c97cf_orderSummary",needGems:"mc403c97cf_needGems",failure:"mc403c97cf_failure",qty:"mc403c97cf_qty",ft:"mc403c97cf_ft",successHd:"mc403c97cf_hd mc403c97cf_successHd",successBd:"mc403c97cf_bd mc403c97cf_successBd",successItem:"mc403c97cf_successItem",successDetails:"mc403c97cf_successDetails",successTotal:"mc403c97cf_successTotal",successRecipients:"mc403c97cf_successRecipients",successMessage:"mc403c97cf_successMessage",recipientsList:"mc403c97cf_recipientsList",recipient:"mc403c97cf_recipient",failedRecipient:"mc403c97cf_recipient mc403c97cf_failedRecipient",successName:"mc403c97cf_successName",successPrice:"mc403c97cf_successPrice",successButton:"mc403c97cf_successButton"};const Ca=window.gemstore_strings.gifting;const Pa=window.gemstore_strings.gifting;var Sa={oninit:function(){ke.gifting={order:{},success:!1,contacts:[]}},view:function(t){const n=function(){const e={cost:0,quantity:0,recipients:0};return s.each(ke.gifting.order,(t=>{e.recipients+=1,e.quantity+=t.count,e.cost+=t.price})),e}(),i=t.attrs.item;return ke.gifting.success?function(e){const t=ke.gifting.success;return r("div",{class:Ta.gifting},r("div",{class:Ta.successHd},r("h2",{class:Ta.title},Ca.step.success.title),r("div",Ca.step.success.intro)),r("div",{class:Ta.successBd},r("div",{class:Ta.successDetails},r("div",Ca.step.success.summary.title),r("div",{class:Ta.successItem},zi(e,{class:Ta.icon}),r("div",e.name)),ke.gifting.success.message?r("div",Ca.step.success.summary.messagelabel,r("div",{class:Ta.successMessage},ke.gifting.success.message)):null,r("div",Ca.step.success.summary.totallabel,r("div",{class:Ta.successTotal},r(hn,{amount:t.totalPrice})))),r("div",r("div",Ca.step.success.summary.recipientslabel),r("div",{class:Ta.successRecipients},r("ul",{class:Ta.recipientsList},t.purchases.map((e=>r("li",{class:e.failure?Ta.failedRecipient:Ta.recipient,onmouseenter:e.failure&&ca(Ca.error.purchase.contact),onmouseleave:e.failure&&ca()},r("div",{class:Ta.successName},e.recipient.name),e.success&&r("div",{class:Ta.successPrice},e.count,Ca.quantityforprice,r(hn,{amount:e.price}))))))))),r("button",{class:mn(On.btn,Ta.successButton),onclick:ke.hidePopup},window.gemstore_strings.flow.button.ok))}(i):r("div",{class:Ta.gifting},r("div",{class:Ta.hd},r("h2",{class:Ta.title},Pa.step.gifts.title),r("div",Pa.step.gifts.intro)),r("div",{class:Ta.bd},r(xa,i),r("div",{class:Ta.numRecipients},`${Pa.step.success.summary.recipientslabel} ${n.recipients}`),r("div",{class:Ta.summary},r("div",{class:Ta.item},zi(i,{class:Ta.icon}),r("div",i.name)),r("textarea[maxlength=500]",{class:Ta.message,placeholder:Pa.step.gifts.messageplaceholder}),r("div",{class:Ta.orderSummary},ke.gifting.failure?r("div",{class:Ta.failure},Pa.error.purchase.general):[r("div",{class:Ta.qty},`${Pa.step.gifts.summary.quantitylabel} ${n.quantity}`),r("div",{class:mn(e.stats.gems<n.cost&&Ta.needGems)},`${Pa.step.gifts.summary.costlabel} `,r(hn,{amount:n.cost}))]))),r("div",{class:Ta.ft},r("button",{class:On.btn,onclick:ke.hidePopup},window.gemstore_strings.flow.button.cancel),r("button",{class:On.btn,disabled:n.recipients<=0||ke.gifting.failure,onclick:()=>{const t=Object.keys(ke.gifting.order).map((e=>ke.gifting.order[e]));e.stats.gems<n.cost?Ri():ua(t,{message:document.querySelector(`.${Ta.message}`).value}).then((e=>{e.purchases.sort((e=>!e.failure)),ke.gifting.success=e})).catch((()=>{ke.gifting.failure=!0})).then(r.redraw)}},Pa.step.gifts.nextbutton)))}};const $a="mcaedea2a5_links";var Ea={links:$a,link:"mcaedea2a5_link",enabled:"mcaedea2a5_enabled",disabled:"mcaedea2a5_disabled",icon:"mcaedea2a5_icon"},Da={view(e){const t=e.attrs,n=t.item,i=window.gemstore_strings;return!t.package&&n.giftable?r("button",{class:[Ea.link,ke.features.gifting.enabled?Ea.enabled:Ea.disabled].join(" "),onclick:n.missingFeatures?vn:function(e){e.stopPropagation(),ke.features.gifting.enabled&&(kn({action:"open:gifting",clickedGuid:n.guid}),ke.showPopup((()=>r(Sa,{item:n}))))},onmouseenter:ca(ke.features.gifting.enabled?i.tooltip.gift:ke.features.gifting.tooltip),onmouseleave:ca()},r(la,{name:"gift",class:Ea.icon})):null}};const Oa=window.gemstore_strings;var Aa={view(e){const t=e.attrs,n=t.item;return t.package&&!ke.isPreviewable(n.guid)?null:r("div",{class:t.class||Ea.links},!t.package&&n.isPackage?r("button",{class:Ea.link,onclick:e=>{if(ke.search.package)return r.route.set(`/category/${ke.search.category.join("/")}?guid=${n.guid}`);n.isPackage&&(e.stopPropagation(),ke.highlightItem(n,ke.search.category))},onmouseenter:ca(ke.search.package?Oa.tooltip.back:Oa.tooltip.packageDetails),onmouseleave:ca()},r(la,{class:Ea.icon,name:ke.search.package?"package-off":"package"})):null,ke.isPreviewable(n.guid)?r("button",{class:Ea.link,onclick:e=>{e.stopPropagation(),xe(n,document.querySelector(t.selector))},onmouseenter:ca(Oa.tooltip.preview),onmouseleave:ca()},r(la,{name:"preview",class:Ea.icon})):null,r(Da,t))}};const La="mc040d47b5_item",Ga="mc040d47b5_name";var qa={$values:{callout:Zi,itemLinksCss:'"../item-links/links.css"'},item:La,packageNoPreview:"mc040d47b5_item mc040d47b5_packageNoPreview",content:"mc040d47b5_content",iconContainer:"mc040d47b5_iconContainer",previewable:"mc040d47b5_iconContainer mc040d47b5_previewable",packageIcon:"mc040d47b5_iconContainer mc040d47b5_packageIcon",name:Ga,links:"mcaedea2a5_links mc040d47b5_links",bd:"mc040d47b5_bd",detailsBox:"mc040d47b5_detailsBox",endingTime:"mc040d47b5_endingTime",endingLimit:"mc040d47b5_endingLimit",details:"mc040d47b5_details",alert:"mc040d47b5_alert",callout:"mc040d47b5_callout",sale:"mc040d47b5_sale",expiring:"mc040d47b5_expiring",returning:"mc040d47b5_returning",mustHave:"mc040d47b5_mustHave",new:"mc040d47b5_new",locked:"mc040d47b5_locked",itemTransitionStart:"mc040d47b5_itemTransitionStart"},Ra={view:function(e){const t=e.attrs.item,n=t.isPackage||ke.isPreviewable(t.guid);let i=ke.isPreviewable(t.guid)?qa.previewable:qa.iconContainer;return t.isPackage&&(i=ke.search.package?qa.packageOffIcon:qa.packageIcon),r("li",{"data-guid":t.guid,"data-id":t.dataId,"data-hover":!!n&&"",class:mn(!ke.previewType&&ke.search.package?qa.packageNoPreview:qa.item,t.callout.type&&qa[t.callout.type]),onmouseenter:()=>{t.tags.musthave&&function({gem_store_item_id:e,tags:t}){const n=Ae.mustHave[e];n&&n===t.musthave.end||(Ae.mustHave[e]=t.musthave.end,Le())}(t)},onclick:()=>ke.search.package?r.route.set(`/category/${ke.search.category.join("/")}?guid=${t.guid}`):t.isPackage?ke.highlightItem(t,ke.search.category):ke.isPreviewable(t.guid)?xe(t,e.dom):void(e.dom&&setTimeout((()=>{e.dom.scrollIntoView({behavior:"smooth",block:"nearest"})}),0))},r("div",{class:qa.content},zi(t,{containerClass:i,attrs:{onclick:e=>Hn(null,e),onmouseenter:e=>Hn(t,e),onmouseleave:e=>Hn(null,e)}}),r("div",{class:qa.bd},t.callout?r("div",{class:qa.callout},s.get(t,"callout.text")):null,r("h2",{class:qa.name},t.name),Bi(t),t.callout.details||t.callout.getDetails?r("div",{class:qa.detailsBox},r("div",{class:mn(qa.details,"endingTime"===t.callout.type&&qa.countdown)},r(la,{class:qa.alert,name:"alert"}),t.callout.details||t.callout.getDetails&&t.callout.getDetails())):null)),n||t.giftable?r(Aa,{item:t,class:qa.links,selector:`[data-guid="${t.guid}"]`}):null)}};const Ma="mcf7f9c0db_itemList";var Fa={itemList:Ma,listSingleColumn:"mcf7f9c0db_itemList mcf7f9c0db_listSingleColumn",container:"mcf7f9c0db_container",containerSingle:"mcf7f9c0db_container mcf7f9c0db_containerSingle",bling:"mcf7f9c0db_bling",noResults:"mcf7f9c0db_noResults",extra:"mcf7f9c0db_noResults mcf7f9c0db_extra",recHeader:"mcf7f9c0db_recHeader"};var Na={$values:{itemLinksCss:'"../item-links/links.css"',itemCss:'"../item/item.css"'},packageList:"mc0a1d7bce_packageList",contains:"mc0a1d7bce_contains",items:"mcf7f9c0db_itemList mc0a1d7bce_items",item:"mc040d47b5_item mc0a1d7bce_item",content:"mc040d47b5_content mc0a1d7bce_content",icon:"mca661b516_icon mc0a1d7bce_icon",name:"mc040d47b5_name mc0a1d7bce_name",quantity:"mc0a1d7bce_quantity",bd:"mc0a1d7bce_bd",links:"mcaedea2a5_links mc0a1d7bce_links",excluded:"mc0a1d7bce_excluded"};const Ha=GW2?.config?.enablePartialPricing;function Ba(e){return r("ul",{class:Na.items,key:"packageItems"},e.map((e=>{const t=e.guid,n=me(t);return n?r("li",{class:mn(Na.item,Ha&&ke.isUnlocked(t)&&qa.unlocked),"data-pkgitem":t,onclick:ke.isPreviewable(t)&&(e=>xe(n,e.currentTarget))},r("div",{class:Na.content},zi(n,{class:Na.icon,containerClass:ke.isPreviewable(t)?qa.previewable:qa.iconContainer,attrs:{onmouseenter:e=>Hn(n,e),onmouseleave:e=>Hn(null,e)}}),r("div",{class:Na.bd},r("h2",{class:Na.name},n.name)),e.quantity>1&&r("div",{class:Na.quantity},r.trust(`&times; ${e.quantity}`))),r(Aa,{item:n,class:Na.links,package:!0,selector:`[data-pkgitem="${t}"]`})):null})))}var ja={view:()=>{const e=me(ke.search.package),t=e&&e.included,n=e&&e.excluded;return t||n?r("div",{class:ke.previewType?Fa.containerSingle:Fa.container},r("ul",r(Ra,{item:e})),r("div",{class:Na.contains},window.gemstore_strings.items.item.package.contains),r("div",{class:Na.packageList},Ba(t),n.length?r("div",{class:Na.excluded},r("p",window.gemstore_strings.items.item.package.warning),Ba(n)):null)):null}};const Ua=window.gemstore_strings;function za(e){let t;if(ke.searchResults.length){if(ke.clickedItem){if(ke.resultsChanged&&(ke.resultsChanged=!1),t=document.querySelector(`[data-guid='${ke.clickedItem}'],[data-id='${ke.clickedItem}']`),!t)return;ke.clickedItem=null,t.classList.remove(Fa.bling),requestAnimationFrame((()=>{!function(e,t,n,i){const a=e.scrollTop,r=e.clientHeight,s=Math.min(t.offsetTop-e.offsetTop,e.scrollHeight-r),o=s-a,c=Date.now();r&&Math.abs(o)<r&&(n=Math.abs(Math.floor(n*o/e.clientHeight))),window.requestAnimationFrame((function t(){const r=Date.now()-c,l=function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}(r,a,o,n);return e.scrollTop=Math.floor(l),r<=n&&s!==a?window.requestAnimationFrame(t):(e.scrollTop=s,"function"==typeof i?i():void 0)}))}(e.dom,t,750,(()=>{t.classList.add(Fa.bling),r.redraw()}))}))}ke.resultsChanged&&requestAnimationFrame((()=>{requestAnimationFrame((()=>{ke.resultsChanged=!1,r.redraw()}))}))}else ke.resultsChanged=!1}var Wa={view:()=>{const e=!ke.search.package&&!ke.searchResults.length,t=ke.search.category&&j[ke.search.category.slice(-1)].displayname;let n=[],i=ke.searchResults;return ke.search.package&&ke.searchResults[0]?r(ja):(e&&(i=ke.noResultsFiller),!e&&ke.extraResults.length&&(n=[r("li",{class:Fa.extra},ke.extraRecsOnly?Ua.noResultsRecs:$e.sub(Ua.extraResults,{category:t}))].concat(ke.extraResults.map((e=>r(Ra,{key:e.guid,item:e}))))),r("div",{class:ke.previewType?Fa.containerSingle:Fa.container},e&&ke.search.text?.length?[r("h4",{class:Fa.noResults},ke.search.category?$e.sub(Ua.noResultsCategory,{category:t}):Ua.noResults),r("div",{class:Fa.recHeader},Ua.noResultsRecs)]:null,r("ul",{class:mn(ke.previewType?Fa.listSingleColumn:Fa.itemList,ke.resultsChanged&&!ke.clickedItem&&qa.itemTransitionStart),"item-list":!0,oncreate:za,onupdate:za},i.map((e=>r(Ra,{key:e.guid,item:e}))).concat(n))))}};var Ya="mc92b93a94_body",Qa={oninit:de,view:()=>r("div",{class:Ya},r(Wa),r(oa))};const Va=window.gemstore_strings,Ka=$e.sub,Xa=GW2.config.banners||{},Ja=GW2.config.upsells||{};let Za,er,tr=0;function nr(){let e=ke.carouselResults;return e.length>0&&ke.upsell.guid&&(e=[me(ke.upsell.guid)].concat(ke.carouselResults).filter(Boolean)),e}function ir(t){const n=nr(),i=t.index,a=(t.index+n.length-1)%n.length,o=(t.index+1)%n.length,c=n[i],l=n[a],u=n[o],d="active"===t.type&&("banner"!==c.type||c.gemStoreBannerItem);return l.carouselIndex=a,c.carouselIndex=i,u.carouselIndex=o,r("li",{class:mn(na.item,na[t.type]),onmouseenter:d&&ca(Va.tooltip.details),onmouseleave:d&&ca(),onclick(t){if(!d)return;const n=Xa[c.guid];if(n&&document.querySelector("[data-splash]").contains(t.target)){if("Exchange"===n)return e.call("ChangeTab","Exchange");e.call("ShowInDefaultBrowser",Ka(n,{lang:e.stats.language}))}return c.tags.hot?(ke.goToCategory(c),null):c.guid===ke.upsell.guid&&Ja[ke.upsell.name].route?(localStorage.upgradeType=Ja[ke.upsell.name].route,e.import("gw2/ui/dialog").then((e=>{e.toggleNative("UpSell")})),null):(ke.highlightItem(c,null,{src:"carousel",position:i}),null)}},n.map((e=>{let t=e.blurb;return e.isExchange&&(t=Ka(e.blurb,{gold:ke.exchange.gold,gems:ke.exchange.gems})),r("div",{class:mn(na.banner,e.carouselIndex===a&&na.left,e.carouselIndex===i&&na.middle,e.carouselIndex===o&&na.right),"data-guid":e.guid,key:e.guid},zi(e,{imageSize:"splash",class:na.icon}),r("div",{class:na.text},e.callout&&r("div",{class:na[e.callout.type]},s.get(e,"callout.text")),r("h2",{class:na.name},t?t.split("<br>").map((e=>r("div",r.trust(e)))):e.name)))})))}function ar(e,{interaction:t,position:n}={}){Date.now()-300<tr||(t&&kn({action:"interaction",source:"carousel",interaction:t,position:n}),ke.carousel={index:e,prevIndex:ke.carousel.index},tr=Date.now())}function rr(){Za&&(clearTimeout(Za),Za=null)}function sr(){rr(),Za=setTimeout((()=>{ar((ke.carousel.index+1)%nr().length,!1),r.redraw(),sr()}),ke.upsell.guid&&0===ke.carousel.index?1e4:5e3)}var or={oninit(){sr()},onremove:rr,view(e){const t=ke.carousel,n=nr(),i=(t.index+n.length-1)%n.length,a=(t.index+1)%n.length;return n.length?r("div",{class:na.carousel,"data-splash":!0,onmousewheel(e){const t=e.wheelDelta>0;ar(t?i:a,{interaction:t?"scrollPrev":"scrollNext"})},onmousedown(e){er=e.x},onmouseup(e){e.x>er+40&&ar(i,{interaction:"dragNext"}),e.x<er-40&&ar(a,{interaction:"dragPrev"})},onmouseenter:e=>{rr(),e.redraw=!1},onmouseleave:e=>{sr(),e.redraw=!1}},r("div",{class:na.prevPage,onclick:ar.bind(null,i,{interaction:"clickPrev"}),onmouseenter:ca(Va.tooltip.previous),onmouseleave:ca()}),r("div",{class:na.nextPage,onclick:ar.bind(null,a,{interaction:"clickNext"}),onmouseenter:ca(Va.tooltip.next),onmouseleave:ca()}),r("ul",{class:`${na.items}  ${e.state.skipAnimation?na.skipAnimation:""}`},[{index:i,type:"prev"},{index:t.index,type:"active"},{index:a,type:"next"}].map(ir)),r("div",{class:na.pager},n.map(((n,s)=>r("div",{class:mn(na.indicator,s===t.index&&na.activePage),onclick(){ar(s,{interaction:"clickPager",position:s}),s!==t.index&&s!==a&&s!==i&&(e.state.skipAnimation=!0,window.requestAnimationFrame((()=>window.requestAnimationFrame((()=>{e.state.skipAnimation=!1})))))}}))))):null}};const cr="mc24de9124_item";var lr={$values:{callout:Zi,iconCss:'"../icon/icon.css"',itemButtonsCss:'"../item-buttons/item-buttons.css"'},container:"mc24de9124_container",categoryName:"mc24de9124_categoryName",items:"mc24de9124_items",item:cr,active:"mc24de9124_active",callout:"mc24de9124_callout",bigItem:"mc24de9124_item mc24de9124_bigItem",smallItem:"mc24de9124_item mc24de9124_smallItem",prices:"mc24de9124_prices",giftingLink:"mc24de9124_giftingLink",name:"mc24de9124_name",bigPlaceholder:"mc24de9124_bigPlaceholder",bigContainer:"mc24de9124_bigContainer",incoming:"mc24de9124_incoming",outgoing:"mc24de9124_outgoing",endingTime:"mc24de9124_endingTime",endingLimit:"mc24de9124_endingLimit",new:"mc24de9124_new",expiring:"mc24de9124_expiring",returning:"mc24de9124_returning",mustHave:"mc24de9124_mustHave",sale:"mc24de9124_sale",empty:"mc24de9124_empty",scaleIcon:"mc24de9124_scaleIcon",smallIcon:"mca661b516_icon mc24de9124_smallIcon",smallItems:"mc24de9124_smallItems"};const ur=window.gemstore_strings;var dr={oninit:e=>{e.state.activeIndex={},e.state.prevBigItem={}},view:e=>r("div",{class:lr.container},ke.featuredResults.map(((t,n)=>{const i=t.items.concat([null,null]).slice(0,3);let a=e.state.activeIndex[t.category.id]||0,o=i[a];null===o&&(e.state.activeIndex[t.category.id]=0,a=e.state.activeIndex[t.category.id],o=i[a]);const c=Boolean(o);return r("div",r("div",{class:lr.categoryName},r.trust(`&nbsp;${t.category.displayname}&nbsp;`)),r("div",{class:lr.items},r("div",{class:lr.bigPlaceholder},r("div",{class:lr.bigContainer,key:o.guid,oncreate:e=>{requestAnimationFrame((()=>e.dom.classList.add(lr.incoming)))},onbeforeremove:e=>new Promise((t=>{e.dom.addEventListener("transitionend",t),e.dom.classList.add(lr.outgoing)}))},r("div",{class:mn(lr.bigItem,lr[s.get(o,"callout.type")]),"data-guid":o?o.guid:"",onclick:()=>{ke.highlightItem(o,t.category.id,{src:"featured",position:a})},onmouseenter:ca(ur.tooltip.details),onmouseleave:ca()},r("div",{class:lr.callout},s.get(o,"callout.text")),c&&[r("div",{class:lr.scaleIcon},zi(o,{expand:!0}))]),c&&r("div",{class:lr.prices},r("div",{class:lr.name},o.name),Bi(o)),!o.package&&o.giftable?r("div",{class:lr.giftingLink},r(Da,{item:o})):null)),r("div",{class:lr.smallItems},t.items.length>1&&i.map(((i,o)=>r("div",{class:mn(lr.smallItem,i&&i.guid?"":lr.empty,lr[s.get(i,"callout.type")],a===o?lr.active:""),"data-guid":i?i.guid:"",onclick:()=>{ke.highlightItem(i,t.category.id,{src:"featured",position:a,section:n})},onmouseenter:ca(ur.tooltip.details,(()=>{kn({action:"interaction",interaction:"commerce/hover",source:"featured",position:o,section:n}),e.state.activeIndex[t.category.id]=o})),onmouseleave:ca()},c&&r("div",{class:lr.scaleIcon},zi(i,{class:lr.smallIcon,expand:!0}))))))))})))};var mr="mcbc0613d0_home",gr={oninit:de,view:()=>r("div",{class:mr},r(or,"splash"),r(dr))},fr={oninit:de,view:()=>r("div",{class:Ya},r(ja),r(oa))},pr={oninit:de,view:()=>r("div",{class:Ya},r(Wa),r(oa))};function hr(e){e.classList.add(ni)}var vr=function(e,t){t.redraw=!1,t.preventDefault(),t.stopPropagation(),"/history"!==e?r.route.set(`/category/${e.join("/")}?src=${e.length>1?"flyout":"nav"}`):r.route.set("/history")},br=function(e){if(ke.flyout&&ke.flyout.slice(-1)[0]===e.slice(-1)[0])return;ke.setFlyout(e);const t=oe({category:e});ke.flyoutResults={thumbnails:t.slice(0,9),featured:t[0]}};const yr="mcf18d2ace_callout";var _r={$values:{callout:Zi,iconCss:'"../icon/icon.css"'},suggestions:"mcf18d2ace_suggestions",incoming:"mcf18d2ace_incoming",outgoing:"mcf18d2ace_outgoing",thumbnails:"mcf18d2ace_thumbnails",featured:"mcf18d2ace_featured",learnMore:"mc2f4756c4_serif mcf18d2ace_learnMore",callout:yr,sale:"mcf18d2ace_callout mcf18d2ace_sale",endingTime:"mcf18d2ace_callout mcf18d2ace_endingTime",endingLimit:"mcf18d2ace_callout mcf18d2ace_endingLimit",expiring:"mcf18d2ace_callout mcf18d2ace_expiring",new:"mcf18d2ace_callout mcf18d2ace_new",returning:"mcf18d2ace_callout mcf18d2ace_returning",mustHave:"mcf18d2ace_callout mcf18d2ace_mustHave",bannerText:"mcf18d2ace_bannerText",bannerContainer:"mcf18d2ace_bannerContainer",banner:"mca661b516_icon mcf18d2ace_banner",iconContainer:"mca661b516_container mcf18d2ace_iconContainer",icon:"mca661b516_icon mcf18d2ace_icon"};function wr(e,t){ke.highlightItem(me(e),ke.flyout,t),ke.setFlyout(null)}var xr={oncreate:e=>{requestAnimationFrame((()=>e.dom&&e.dom.classList.add(_r.incoming)))},onbeforeremove:e=>new Promise((t=>{e.dom.addEventListener("transitionend",t),e.dom.classList.add(_r.outgoing)})),view:()=>{const t=ke.flyoutResults,n=t&&t.featured;let i;return n?(i=n.blurb&&n.blurb.replace(/<[^>]*>/g," "),n.isExchange&&(i=$e.sub(i,{gold:ke.exchange.gold,gems:ke.exchange.gems})),r("div",{class:_r.suggestions},!n.isExchange&&r("div",{class:_r.thumbnails},t.thumbnails.map(((e,t)=>zi(e,{class:_r.icon,containerClass:`${_r.iconContainer} ${_r[e.callout.type]}`,attrs:{onclick:wr.bind(null,e.guid,{src:"flyout",position:t}),onmouseenter:t=>Hn(e,t),onmouseleave:e=>Hn(null,e)}})))),r("div",{class:_r.featured},r("div",{class:_r.bannerContainer,onmouseenter:ca(window.gemstore_strings.tooltip.details),onmouseleave:ca(),onclick:()=>n.isExchange?e.call("ChangeTab","Exchange"):wr(n.guid,{src:"flyout",position:9})},zi(n,{class:_r.banner,imageSize:"splash"}),i?r("button",{class:_r.learnMore},window.gemstore_strings.banner.learnMore):r("div",{class:_r.bannerText},n.name)),r("div",{class:mn(n.callout.type&&_r[n.callout.type])},n.callout.text),i))):null}};var kr="mcb4615a9d_flyout",Ir="mcb4615a9d_categories",Tr="mcb4615a9d_category",Cr="mcb4615a9d_hovered",Pr="mcb4615a9d_categoryInfo",Sr="mcb4615a9d_history",$r="mcb4615a9d_noHistory";const Er=window.gemstore_strings.nav;function Dr(){e.call("ChangeTab","Exchange")}function Or(e,t){const n=[e];if(t&&!t.hasItems)return null;t&&n.push(t.id);const i=t&&ke.flyout&&ke.flyout[1]===t.id;return r("li",{class:mn(Tr,i&&Cr),onclick:t&&t.isExchange?Dr:e=>{ke.setFlyout(null),vr(n,e)},onmouseenter:()=>br(n)},t?t.displayname:$e.sub(Er.allCategory,{category:j[e].displayname}))}var Ar={view:()=>{const e=ke.flyout&&j[ke.flyout[0]];return"history"===ke.flyout?r("div",{class:kr},r("div",{class:Sr},ke.purchases.length>0?r("ul",ke.purchases.map(Yi)):r("div",{class:$r},Er.noHistory)),r("div",{class:Pr},Er.recent)):ke.flyout&&-1!==ke.flyout.indexOf(e.id)?r("div",{class:kr},r("ul",{class:Ir,"data-longlist":(j[e.id].childCategories.length>=9).toString()},Or(e.id),j[e.id].childCategories.map((t=>Or(e.id,t)))),[r(xr,{key:ke.flyout.join("-")})],r("div",{class:Pr},j[e.id].description)):null}};const Lr=window.gemstore_strings.nav;var Gr={oninit(e){e.state.buyHover=!1,ke.openBuyGems&&(ke.openBuyGems=!1,Ri())},view:t=>r("div",{class:Xn.nav,"data-test":"nav"},r("div",{class:mn(Xn.balance,t.state.buyHover&&Xn.buyHover)},r("div",{class:Xn.top},r(hn,{amount:e.stats.gems,cssClass:Xn.gems}),r("button",{class:ke.features.billing.enabled?Xn.buyGems:Xn.buyDisabled,onclick:Ri,onmouseenter:ca(ke.features.billing.tooltip,(()=>t.state.buyHover=!0)),onmouseleave:ca(null,(()=>t.state.buyHover=!1))},Lr.balance.buygems)),r("a",{class:ke.features.codes.enabled?Xn.redeemCode:Xn.redeemDisabled,onclick:()=>{ke.features.codes.enabled&&(GW2.config.features.itemCodesOnly?ke.showPopup((()=>r(Yn))):ui("codes"))},onmouseenter:ca(ke.features.codes.tooltip),onmouseleave:ca()},Lr.balance.redeemcode)),r("div",{class:Xn.sections,onmouseleave:()=>ke.setFlyout(null)},j.root.childCategories.map((e=>{const t=[e.id];return r("button",{class:mn(Xn.section,ke.flyout&&-1!==ke.flyout.indexOf(e.id)&&Xn.hover,ke.search.category&&-1!==ke.search.category.indexOf(e.id)&&Xn.active),onclick:e=>{ke.setFlyout(null),vr(t,e)},onmouseenter:()=>br(t)},r(la,{class:Xn.icon,name:e.name}),r("p",{class:Xn.text},j[e.id].displayname))})),r("button",{class:mn(Xn.section,ke.onHistory()&&Xn.active),onclick:ke.purchases.length>0?e=>{ke.setFlyout(null),vr("/history",e)}:null,onmouseenter:ke.purchases.length<1?ca(Lr.noHistory):()=>{ke.setFlyout("history"),ke.flyoutResults=null},onmouseleave:e=>{ca()(e),e.redraw=!0}},r(la,{class:Xn.icon,name:"purchases"}),r("p",{class:Xn.text},Lr.history)),r(Ar)))};const qr={dropdownCss:'"../../dropdown.ea6bc35.css"',height:"30px"},Rr="mcff32c4a2_button",Mr=fa+" mcff32c4a2_dropdown",Fr=pa+" mcff32c4a2_ddItem";var Nr={$values:qr,searchbar:"mcff32c4a2_searchbar",homebar:"mcff32c4a2_searchbar mcff32c4a2_homebar",button:Rr,home:"mcff32c4a2_button mcff32c4a2_home",icon:"mcff32c4a2_icon",back:"mcff32c4a2_button mcff32c4a2_back",breadcrumbs:"mcff32c4a2_breadcrumbs",dropdown:Mr,ddItem:Fr,visibleCrumbs:"mcff32c4a2_breadcrumbs mcff32c4a2_visibleCrumbs"};const Hr="mc5706bb31_icon";var Br={$values:{height:qr.height,searchbarCss:'"./search-bar.css"'},breadcrumb:"mc5706bb31_breadcrumb",name:"mc5706bb31_name",all:"mc5706bb31_breadcrumb mc5706bb31_all",icon:Hr,arrow:"mc5706bb31_icon mc5706bb31_arrow",remove:"mc5706bb31_icon mc5706bb31_remove",dropdown:"mc8f8cb826_dropdown mcff32c4a2_dropdown mc5706bb31_dropdown",ddItem:"mc8f8cb826_ddItem mcff32c4a2_ddItem mc5706bb31_ddItem"};function jr(e,t){const n=t.currentTarget;!_e()||Array.prototype.indexOf.call(n.parentNode.children,n)<1||("mouseenter"===t.type?he():pe())}var Ur={view:e=>r("div",s.merge({class:Br.breadcrumb,"data-removable":!e.attrs.all,onmouseenter:e.attrs.dropdown?ca(null,(e=>jr(0,e))):null,onmouseleave:e.attrs.dropdown?ca(null,(e=>jr(0,e))):null},e.attrs.attrs||{}),r("p",{class:Br.name},e.attrs.name),e.attrs.dropdown&&r(la,{class:Br.arrow,name:"arrow"}),!e.attrs.all&&e.attrs.dropdown&&r(la,{class:Br.remove,name:"remove"}),e.attrs.dropdown||null)};const zr=window.gemstore_strings;var Wr={view:e=>{const t=e.attrs.category,n=e.attrs.idx,i="_all"===t,a=ke.search.category,s=0===n?j.root:j[a[n-1]];return r(Ur,{idx:n,all:i,name:i?zr.nav.category.all:j[t].displayname,dropdown:r("ul",{class:Br.dropdown},s.childCategories.map((e=>e.id===a[n]||!e.hasItems||e.isExchange?null:r("li",{class:Br.ddItem,onclick:t=>{t.stopPropagation(),a[n]=e.id,pe(),r.route.set(`/category/${a.slice(0,n+1).join("/")}?src=breadcrumb`)}},e.displayname)))),attrs:{onclick:()=>{pe(),r.route.set(`/category/${a.slice(0,n).join("/")}?src=breadcrumb`)}}})}};var Yr={$values:{height:qr.height,dropdownCss:'"../../dropdown.ea6bc35.css"'},wrapper:"mc4c9a6199_wrapper",input:"mc4c9a6199_input",search:"mc4c9a6199_search",suggestions:"mc8f8cb826_dropdown mc4c9a6199_suggestions",suggestion:"mc8f8cb826_ddItem mc4c9a6199_suggestion"};const Qr=window.gemstore_strings;var Vr={view:()=>{const e=ke.onHome();return r("div",{class:Yr.wrapper,disabled:ke.onHistory()},r("input",{type:"text",class:Yr.input,placeholder:Qr.nav.search,value:ke.search.text||"",onkeydown:t=>{t.redraw=!1,e&&13===t.keyCode&&r.route.set(`/search?${r.buildQueryString({text:t.currentTarget.value})}`)},oninput:t=>{if(ke.search.text=t.currentTarget.value,ke.search.package){const e=r.buildQueryString({text:ke.search.text});r.route.set(`/category/${ke.search.category.join("/")}?${e}`)}e||de()},onblur:()=>{let t,n;ke.search.text&&!e&&(t=r.route.get(),n=t.indexOf("?")>-1,n?(t=t.split("?"),n=r.parseQueryString(t[1]),t=t[0]):n={},n.text=ke.search.text,r.route.set(`${t}?${r.buildQueryString(n)}`))}}),r(la,{class:Yr.search,name:"search",onclick:()=>{ke.search.text&&e&&r.route.set(`/search?${r.buildQueryString({text:ke.search.text})}`)}}),function(){const e=ke.search.category||[];let t=e.length,n=e.length>0?j[e[e.length-1]].childCategories:j.root.childCategories;return e.length>1&&n.length<=0&&(n=j[e[e.length-2]].childCategories,t=e.length-1),ke.search.text&&e.length<=0?null:r("ul",{class:Yr.suggestions},ke.search.text&&e.length>0&&r("li",{class:Yr.suggestion,onclick:()=>r.route.set(`/search?text=${ke.search.text}`)},$e.sub(Qr.nav.searchAll,{search:ke.search.text})),!ke.search.text&&n.map((n=>!n.hasItems||n.id===e[t]||n.isExchange?null:r("li",{class:Yr.suggestion,onclick:()=>{e[t]=n.id,r.route.set(`/category/${e.join("/")}`)}},n.displayname))))}())}};const Kr=window.gemstore_strings;var Xr={view:function(){const e=ke.onHome(),t=ke.onHistory(),n=!e,i=!e&&!t,a=ke.search.category||[],s=a.length?j[a[a.length-1]].childCategories:[];let o;return i&&(o=a.slice(1),!e&&s.length>0&&!ke.search.text&&o.push("_all"),ke.search.package&&o.push("_package")),r("div",{class:e?Nr.homebar:Nr.searchbar},r(Vr),n&&r("button",{class:Nr.home,onclick:()=>r.route.set("/"),onmouseenter:ca(Kr.tooltip.home),onmouseleave:ca()},r(la,{class:Nr.icon,name:"home"})),n&&r("button",{class:Nr.back,onclick:()=>ke.pop(),onmouseenter:ca(Kr.tooltip.back),onmouseleave:ca()},r(la,{class:Nr.icon,name:"back"})),i&&r("div",{class:Nr.breadcrumbs,oncreate:e=>window.requestAnimationFrame((()=>e.dom.className=Nr.visibleCrumbs))},o.map(((e,t)=>{if(t+=1,"_package"===e){const t=`src=breadcrumb&guid=${ke.search.package}`;return r(Ur,{key:e,name:Kr.nav.packageBreadcrumb,attrs:{onclick:()=>r.route.set(`/category/${ke.search.category.join("/")}?${t}`)}})}return r(Wr,{idx:t,key:e+t,category:e})}))))}};var Jr={faded:"faded",overlay:"mcdba90a33_overlay",prompt:"mcdba90a33_prompt",inner:"mcdba90a33_inner",hd:"mcdba90a33_hd",bd:"mc2f4756c4_serif mcdba90a33_bd",ft:"mcdba90a33_ft"};function Zr(e,t,n){return e?r("div",{onclick:function(e){e.currentTarget===e.target&&"function"==typeof n&&n()},class:Jr.overlay},r("div",{class:`${Jr.prompt} ${t}`||""},r("div",{class:Jr.inner},e))):null}const es=ji+" mcf3e33674_smallIcon";var ts={$values:{itemCss:'"../item/item.css"',iconCss:'"../icon/icon.css"',btnCss:'"../item-buttons/item-buttons.css"'},item:"mcf3e33674_item",icon:"icon",bd:"mcf3e33674_bd",name:"mc040d47b5_name mcf3e33674_name",for:"mcf3e33674_for",noVip:"mcf3e33674_noVip",price:"mcf3e33674_price",gemsContainer:"mcf3e33674_gemsContainer",regularPrice:"mcf3e33674_regularPrice",prompt:"mcf3e33674_prompt",savings:"mcf3e33674_savings",vipInfo:"mcf3e33674_vipInfo",confirmBtn:"mc95ee6c1f_btn mc95ee6c1f_blueBig mcbbb59549_button mcf3e33674_confirmBtn",btn:"btn",loading:"mcf3e33674_loading",smallIcon:es,vipUpgrade:"mcf3e33674_vipUpgrade",upgradeText:"mcf3e33674_upgradeText",upgradeBtn:"mcf3e33674_upgradeBtn",regularPriceBlue:"mcf3e33674_regularPrice mcf3e33674_regularPriceBlue",vipApplied:"mcf3e33674_vipApplied"};var ns={hd:"mc11f37c8d_hd",offers:"mc11f37c8d_offers",offer:"mc11f37c8d_offer",icon:"mca661b516_icon mcf3e33674_smallIcon mc11f37c8d_icon"};const is=window.gemstore_strings;var as={view(e){const t=e.attrs.details,n=me(t.info.guid);return r("div",Zr([r("h2",{class:Jr.hd},is.purchasing.ok.title),r("div",{class:mn(Jr.bd,Vn)},r("div",{class:ns.hd},zi(n,{class:ns.icon,attrs:{onmouseenter:e=>Hn(n,e),onmouseleave:e=>Hn(null,e)}}),is.purchasing.ok.info[t.success.instant?"feature":"item"])),r("div",r("button",{class:On.btn,onclick:e.attrs.hide},is.purchasing.ok.button))],"",e.attrs.hide))}};const rs=window.gemstore_strings;var ss={oninit:function(){this.findQuantity=(e,t,n)=>{let i;return e&&t&&(n||0===n)?(e.quantities.some((e=>(e.count===t&&e.price===n&&(i=e),i))),i):null},this.hide=()=>{e.call("SetLoading",!1),_e()&&requestAnimationFrame(pe),ke.purchase={info:!1,inProgress:!1,success:!1}},this.purchase=()=>{const t=ke.purchase,n=me(t.info.guid);return t.info.price>e.stats.gems?(this.hide(),void Ri()):(e.call("SetLoading",!0),ke.purchase.inProgress=!0,ua(t.info).then((()=>{e.call("SetLoading",!1),ke.purchase.success={instant:"upgrade"===n.type},ke.purchase.inProgress=!1,r.redraw()})).catch((()=>this.hide())))}},view:function(t){const n=e.stats.vip,i=ke.purchase,a=i&&i.info&&me(i.info.guid),s=i&&t.state.findQuantity(a,i.info.count,i.info.price);if(!(s||i&&i.success))return null;if(i.failure)return r("div",Zr([r("h2",{class:Jr.hd},rs.purchasing.failure.title),r("div",{class:mn(Jr.bd,Vn)},rs.purchasing.failure.body),r("div",r("button",{class:On.btn,onclick:t.state.hide},rs.purchasing.ok.button))]));if(i.success)return r(as,{details:i,hide:t.state.hide});const o=n&&!n.active&&s.vip_discount_price&&s.vip_discount_price!==s.price;return r("div",{class:mn(i.inProgress&&ts.loading,i.info&&!i.inProgress&&"faded"),oncreate:({dom:e})=>requestAnimationFrame((()=>e.classList.remove("faded")))},Zr(r("div",{class:ts.prompt},r("h2",{class:Jr.hd},rs.purchasing.complete.title),r("div",{class:mn(Jr.bd,Vn)},n&&n.active&&r("div",{class:ts.vipApplied},rs.vip.discount),r("div",{class:ts.item},zi(a,{attrs:{onmouseenter:e=>Hn(a,e),onmouseleave:e=>Hn(null,e)}}),r("div",{class:ts.bd},r("div",{class:ts.name},a.name),r("div",{class:ts.price},s.count,r("span",{class:ts.for},rs.purchasing.complete.for),r("span",{class:ts.gemsContainer},r(hn,{amount:s.price}),s.regular_price?r("div",{class:ts.regularPrice},s.regular_price):null)))),o?r("div",{class:ts.vipUpgrade,onclick:()=>{const e=me("2B0C1514-BA0A-4169-AC35-BE281FCA4DC2");ke.highlightItem(e,e.categories[0]),t.state.hide()}},r("div",{class:ts.upgradeText},rs.vip.upgrade),r("div",{class:ts.gemsContainer},r("button",{class:a.percent_off?Fi.buttonSale:Fi.button},r(hn,{amount:s.vip_discount_price,cssClass:ts.upgradeBtn})),r("span",{class:ts.regularPriceBlue},s.price))):null),r("div",r("button",{class:mn(On.btn,ts.confirmBtn),onclick:t.state.purchase,disabled:ke.purchase.inProgress},rs.purchasing.complete.button),r("button",{class:On.btn,onclick:t.state.hide},rs.flow.button.cancel))),"purchase-prompt",t.state.hide))}};var os="mcf3f281b1_gemstore",cs="mcf3f281b1_cached",ls={view:t=>{const n=e.stats.vip,i=t.attrs.isExternal;return r("div",{class:mn(os,n&&n.active&&"vip",ke.showingCached&&cs),"data-test":"page"},!i&&r(Gr),!i&&r(Xr),t.children,function(t,n,i){return t?r("div",{class:ti,oncreate:e=>hr(e.dom),config:(e,t)=>{t||hr(e)},onclick:function(e){e.target===e.currentTarget&&i()}},r("div",{class:[n||"","gw2cn"===e.buildInfo.gameCode?ai:ii].join(" ")},r("div",{class:ri},t),r("button",{class:oi,onclick:i}))):null}("function"==typeof ke.popup?ke.popup():ke.popup,ke.popupClassname||null,ke.hidePopup),!i&&r(ss))}};e.initSession(),e.initNative().then((function(){const t=window.gemstore_strings,n=ke.isSteamUser()&&!e.stats.tScore;ln().then((()=>{const t=r.parseQueryString(document.location.search);setTimeout(un,10),setTimeout(kn.bind(null,{action:"timer"}),GW2.config.logDelayMs),t.id?ke.highlightItem(oe({dataId:parseInt(t.id,10)})[0]):(t.guid&&(ke.guidToPreviewType.has(t.guid)?ke.highlightItem(ke.catalog[t.guid]):ke.firstLoadPreviewGuid=t.guid),e.import("gw2/datastore").then((e=>{let t;e.gsItem&&(t=ke.catalog[e.gsItem],ke.highlightItem(t),e.remove("gsItem"),r.redraw())})))})),Ce(),window.setInterval(Ce,18e4);const i=u();ke.features={gifting:{enabled:i.check("gifting")&&!n,tooltip:i.check("gifting")?n?t.disabled.tScore:t.tooltip.gift:"restricted"===i.status?t.disabled.free:t.disabled.feature},codes:{enabled:i.check("codes"),tooltip:function(){const n=i.check("codes");return n&&"gw2cn"===e.buildInfo.gameCode?t.tooltip.redeemCode:!n&&ke.is3rdParty()?t.tooltip.redeemSteam:n?null:t.disabled.feature}()},purchasing:{enabled:i.check("purchasing"),tooltip:t.disabled.feature},billing:{enabled:i.check("billing"),tooltip:i.check("billing")?null:t.disabled.feature}},ke.openBuyGems=window.location.search.indexOf("openBuyGems")>-1,e.on("stats",(()=>r.redraw())),r.route(document.body,document.location.pathname,{"/":{onmatch:()=>{ke.closePreview(),ke.search={},r.route.get()&&kn({action:"home"})},render:()=>r(ls,r(gr))},"/history":{onmatch:()=>{ke.closePreview(),ke.search={},kn({action:"history"})},render:()=>r(ls,r(Ki))},"/category/:key...":{onmatch:e=>{const t=e.key.toUpperCase().split("/");t.every((e=>j[e]))||r.route.set("/"),ke.search={category:t},ke.resultsChanged=!0,e.text&&(ke.search.text=window.decodeURIComponent(e.text),ke.resultsChanged=!1),ke.clickedItem=e.guid||e.id&&parseInt(e.id,10),kn({source:e.src,position:e.position})},render:e=>r(ls,r(Qa,e.attrs))},"/search":{onmatch:e=>{ke.search={},e.category&&(ke.search.category=e.category.split("/")),e.text&&(ke.search.text=window.decodeURIComponent(e.text)),kn({source:e.src,position:e.position})},render:()=>r(ls,r(pr))},"/item/:key...":{onmatch:e=>{ke.search={package:e.key,category:window.decodeURIComponent(e.categories).split(",")},kn({source:e.src,position:e.position,section:e.section})},render:e=>r(ls,r(fr,e.attrs))}})})),window.GemStore={i18n:window.gemstore_strings};
//# sourceMappingURL=gemstore.js.map