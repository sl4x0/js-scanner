# Discord Integration
discord_webhook: "https://discord.com/api/webhooks/1450082381934362726/IAgRuWMbRnzpHaAezmqVPJdg05L3yYe9nG48RCV5Io6ob9ekytIqpCYxQDg6z-ljO7M3"
discord_rate_limit: 30 # messages per minute
discord_status_enabled: false # Only send secret alerts, no start/complete notifications

# Notification Batching Strategy
notification_batching:
  strategy: "verified_immediate" # verified_immediate = send verified instantly, batch unverified at phase end
  batch_size: 5 # Max secrets to show per batch message (Discord has 25 field limit)
  group_by_domain: true # Group secrets by domain in batch messages
  min_delay: 1 # Minimum delay between messages (seconds) to avoid rate limits

# TruffleHog
# Cross-platform: Use relative path or leave empty to auto-detect
# Windows: searches for trufflehog.exe | Linux: searches for trufflehog
# Priority: 1) Config path below, 2) Project root, 3) System PATH
trufflehog_path: "" # Leave empty for auto-detection
trufflehog_timeout: 300 # seconds per file
trufflehog_max_concurrent: 5 # Issue #2: Limit concurrent TruffleHog processes

# Fetching
threads: 100 # Reduced to avoid rate limiting
timeout: 10 # seconds (increased for slow servers)
user_agent: "Mozilla/5.0 (BugBounty/Research)"
max_file_size: 209715200 # 200 MB perfile size limit
verify_ssl: false # Set to false to bypass SSL certificate verification errors

# Issue #8: Configurable timeouts
timeouts:
  http_request: 10 # for asyncio HTTP requests (seconds) - reduced from 60s to speed up scans
  playwright_page: 30000 # ms - reduced from 60000ms to avoid long hangs
  trufflehog: 300 # seconds per file

# Playwright
playwright:
  headless: true # Run browser in headless mode
  max_concurrent: 4 # Max concurrent browser instances - reduced from 10 to keep event loop responsive
  restart_after: 100 # Restart browser after N pages
  page_timeout: 30000 # ms - reduced from 60000ms to avoid long hangs on slow/blocked sites

# SubJS Configuration
subjs:
  enabled: true # Enable SubJS by default
  timeout: 10 # Timeout per domain (seconds)

# AST Analysis
ast:
  enabled: true
  max_file_size_mb: 20 # Maximum file size for AST parsing (in MB)

# Bundle Unpacker (v3.0 NEW)
# Requires: npm install -g webcrack
bundle_unpacker:
  enabled: false
  min_file_size: 102400 # 100 KB
  timeout: 300 # seconds
  temp_dir: "temp/unpacked"

# Logging
logging:
  level: "INFO" # DEBUG, INFO, WARNING, ERROR
  file_enabled: true

# Beautification Performance
beautification:
  timeout_small: 120 # Timeout for files < 1MB (seconds)
  timeout_medium: 300 # Timeout for files 1-5MB (seconds)
  timeout_large: 900 # Timeout for files 5-10MB (seconds)
  timeout_xlarge: 1800 # Timeout for files > 10MB (seconds)

# Batch Processing Configuration
batch_processing:
  enabled: true # Enable new batch workflow
  download_threads: 100 # Max concurrent downloads in Phase 2 - fetching
  process_threads: 100 # Max concurrent processing in Phase 4 - beautification & analysis
  cleanup_minified: false # Keep both minified and unminified files after processing

# Retry Configuration (NEW)
retry:
  http_requests: 2 # Max retry attempts for HTTP operations
  subprocess_calls: 2 # Max retry attempts for subprocess operations
  backoff_base: 1.0 # Base delay in seconds for exponential backoff (1s -> 2s -> 4s)
  backoff_multiplier: 2.0 # Multiplier for exponential backoff
  jitter: true # Add random jitter to prevent thundering herd

# Minification Detection (ENHANCED)
minification_detection:
  sample_size: 10000 # Characters to analyze for minification detection
  threshold_score: 5 # Score threshold (0-10) to classify as minified
  # Scoring weights (for reference - hardcoded in engine.py):
  # avg_line_length > 200: +3 points
  # semicolon_density > 5: +2 points
  # whitespace_ratio < 0.15: +2 points
  # short_var_ratio > 0.3: +2 points
  # no_comments: +1 point

# Checkpoint System (NEW)
checkpoint:
  enabled: true # Enable checkpoint system for resumable scans
  frequency: 10 # Save checkpoint every N files (also saves every 30 seconds)
  auto_cleanup: true # Delete checkpoint on successful completion

# Code Splitting Detection (NEW)
code_splitting:
  detect_dynamic_imports: true # Detect import(), require(), lazy loading patterns
  extract_chunk_map: true # Parse webpack/vite chunk manifests
  follow_import_chain: false # Recursively fetch discovered imports (expensive - disabled by default)
  max_import_depth: 2 # Maximum recursion depth if follow_import_chain enabled
  probe_common_locales: ["en", "es", "fr", "de", "ja", "zh"] # For template literal imports like ./locales/${lang}.js
