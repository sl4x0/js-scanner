# Discord Integration
discord_webhook: "https://discord.com/api/webhooks/1450082381934362726/IAgRuWMbRnzpHaAezmqVPJdg05L3yYe9nG48RCV5Io6ob9ekytIqpCYxQDg6z-ljO7M3"
discord_rate_limit: 30 # messages per minute
discord_status_enabled: false # Only send secret alerts, no start/complete notifications

# Notification Batching Strategy
notification_batching:
  strategy: "verified_immediate" # verified_immediate = send verified instantly, batch unverified at phase end
  batch_size: 5 # Max secrets to show per batch message (Discord has 25 field limit)
  group_by_domain: true # Group secrets by domain in batch messages
  min_delay: 1 # Minimum delay between messages (seconds) to avoid rate limits

# TruffleHog
# Cross-platform: Use relative path or leave empty to auto-detect
# Windows: searches for trufflehog.exe | Linux: searches for trufflehog
# Priority: 1) Config path below, 2) Project root, 3) System PATH
trufflehog_path: "" # Leave empty for auto-detection
trufflehog_timeout: 300 # seconds per file
trufflehog_max_concurrent: 5 # Limit concurrent TruffleHog processes (CPU intensive - keep low: 5-10 for VPS)

# Fetching
threads: 50 # Balanced for large URL lists without overwhelming connections
timeout: 15 # seconds (increased for slow servers and large batches)
user_agent: "Mozilla/5.0 (BugBounty/Research)"
max_file_size: 209715200 # 200 MB perfile size limit
verify_ssl: false # Set to false to bypass SSL certificate verification errors
max_concurrent_domains: 10 # Auto-tuned: 50 for --subjs-only, 10 for live scans (override to force specific value)

# Connection Pool Settings (for large URL lists)
connection_pool:
  max_connections: 100 # Maximum total connections
  max_per_host: 10 # Maximum connections per host (prevents overwhelming single domain)
  ttl_dns_cache: 300 # DNS cache TTL in seconds

# Performance Optimizations
interaction_delay: 0.5 # Seconds to wait for network idle after page interactions (0.5 = fast, 3 = thorough)
minimal_storage: false # DISABLED - Keep all files for manual bug bounty analysis

# User-Agent Rotation (randomized per request to avoid WAF fingerprinting)
user_agents:
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
  - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0"
  - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15"
  - "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0"
  - "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"
  - "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0"
  - "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0"

# Issue #8: Configurable timeouts
timeouts:
  http_request: 15 # for asyncio HTTP requests (seconds) - balanced for reliability with large batches
  playwright_page: 15000 # ms - fast timeout to skip slow/blocked sites quickly
  trufflehog: 300 # seconds per file

# Playwright (VPS-optimized)
playwright:
  headless: true # Run browser in headless mode
  max_concurrent: 6 # Max concurrent browser instances (increased for VPS resources)
  restart_after: 100 # Restart browser after N pages
  page_timeout: 12000 # ms - aggressive timeout to skip slow/blocked sites quickly (reduced from 15s)

# SubJS Configuration (VPS-optimized)
subjs:
  enabled: true # Enable SubJS by default
  timeout: 45 # Timeout per domain (seconds) - increased for thorough discovery on VPS

# AST Analysis
ast:
  enabled: true
  max_file_size_mb: 20 # Maximum file size for AST parsing (in MB)

# Bundle Unpacker (v3.0 NEW)
# Requires: npm install -g webcrack
bundle_unpacker:
  enabled: false
  min_file_size: 102400 # 100 KB
  timeout: 300 # seconds
  temp_dir: "temp/unpacked"

# Logging
logging:
  level: "INFO" # DEBUG, INFO, WARNING, ERROR
  file_enabled: true

# Beautification Performance
beautification:
  timeout_small: 120 # Timeout for files < 1MB (seconds)
  timeout_medium: 300 # Timeout for files 1-5MB (seconds)
  timeout_large: 900 # Timeout for files 5-10MB (seconds)
  timeout_xlarge: 1800 # Timeout for files > 10MB (seconds)

# Batch Processing Configuration (VPS-optimized)
batch_processing:
  enabled: true # Enable new batch workflow
  download_threads: 150 # Max concurrent downloads in Phase 2 - fetching (increased for VPS bandwidth)
  process_threads: 120 # Max concurrent processing in Phase 4 - beautification & analysis (increased for VPS CPU)
  cleanup_minified: false # Keep both minified and unminified files after processing (DISABLED for bug bounty manual review)

# Retry Configuration (NEW)
retry:
  http_requests: 5 # Max retry attempts for HTTP operations (1 initial + 4 retries) - increased for reliability
  subprocess_calls: 2 # Max retry attempts for subprocess operations
  backoff_base: 1.0 # Base delay in seconds for exponential backoff (1s -> 2s -> 4s)
  backoff_multiplier: 2.0 # Multiplier for exponential backoff
  jitter: true # Add random jitter to prevent thundering herd

# Minification Detection (ENHANCED)
minification_detection:
  sample_size: 10000 # Characters to analyze for minification detection
  threshold_score: 5 # Score threshold (0-10) to classify as minified
  # Scoring weights (for reference - hardcoded in engine.py):
  # avg_line_length > 200: +3 points
  # semicolon_density > 5: +2 points
  # whitespace_ratio < 0.15: +2 points
  # short_var_ratio > 0.3: +2 points
  # no_comments: +1 point

# Checkpoint System (NEW)
checkpoint:
  enabled: true # Enable checkpoint system for resumable scans
  frequency: 10 # Save checkpoint every N files (also saves every 30 seconds)
  auto_cleanup: true # Delete checkpoint on successful completion

# Code Splitting Detection (NEW)
code_splitting:
  detect_dynamic_imports: true # Detect import(), require(), lazy loading patterns
  extract_chunk_map: true # Parse webpack/vite chunk manifests
  follow_import_chain: false # Recursively fetch discovered imports (expensive - disabled by default)
  max_import_depth: 2 # Maximum recursion depth if follow_import_chain enabled
  probe_common_locales: ["en", "es", "fr", "de", "ja", "zh"] # For template literal imports like ./locales/${lang}.js
